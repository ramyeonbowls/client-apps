<?php
/*   __________________________________________________
    |  Obfuscated by Tarmun - Php Obfuscator  2.0.14  |
    |              on 2024-11-23 17:36:13             |
    |                                                 |
    |_________________________________________________|
*/
 namespace App\Http\Controllers\Core\Report; use App\Logs; use Exception; use Throwable; use Carbon\Carbon; use Illuminate\Support\Arr; use Illuminate\Support\Str; use Illuminate\Http\Request; use Illuminate\Http\JsonResponse; use Illuminate\Support\Facades\DB; use App\Http\Controllers\Controller; use Maatwebsite\Excel\Facades\Excel; use App\Exports\Report\VisitorsReportExport; use App\Services\Report\VisitorsReportService; use Yajra\DataTables\Facades\DataTables; class VisitorsReportController extends Controller { private VisitorsReportService $visitors_service; public function __construct() { $this->middleware("\141\x75\164\x68"); $this->visitors_service = new VisitorsReportService(); } public function index(Request $request) : JsonResponse { goto jxM_A; V1tTl: try { goto k1Uml; Zsu1a: $filter["\113\x41\102\125\x50\101\x54\x45\116"] = $request->KABUPATEN ?? ''; goto TT7I7; HBNwE: $filter["\123\x54\x41\122\x54\137\104\101\x54\x45"] = $request->START_DATE ?? ''; goto t0CHm; t0CHm: $filter["\105\x4e\104\137\x44\101\124\x45"] = $request->END_DATE ?? ''; goto nqgcQ; K1oOT: $q++; goto XGEqn; rmk5_: IL8xE: goto QbFs0; XGEqn: goto U2tdv; goto rmk5_; Np4vH: $q = 0; goto YIDTS; y6Jex: $logs->write("\102\111\116\x44\111\x4e\107", "\x5b" . implode("\x2c\40", $queries[$q]["\x62\151\156\x64\151\x6e\147\163"]) . "\x5d"); goto N99oA; k1Uml: DB::enableQueryLog(); goto ZqOLz; nqgcQ: $results = $this->visitors_service->get($filter); goto LP6io; ZqOLz: $filter["\120\x52\x4f\x56\x49\116\123\111"] = $request->PROVINSI ?? ''; goto Zsu1a; N99oA: $logs->write("\123\121\x4c", $sql); goto j5L8Z; TT7I7: $filter["\x57\114"] = $request->WL ?? ''; goto HBNwE; LP6io: $queries = DB::getQueryLog(); goto Np4vH; YIDTS: U2tdv: goto ChI9v; y_C8Y: $sql = Str::replaceArray("\x3f", $queries[$q]["\142\x69\156\144\151\x6e\147\163"], str_replace("\x3f", "\x27\x3f\47", $queries[$q]["\x71\x75\x65\x72\171"])); goto y6Jex; ChI9v: if (!($q < count($queries))) { goto IL8xE; } goto y_C8Y; j5L8Z: vNqhH: goto K1oOT; QbFs0: } catch (Throwable $th) { $logs->write("\x45\122\122\x4f\x52", $th->getMessage()); } goto yodCU; E43js: $results = []; goto V1tTl; yodCU: $logs->write(__FUNCTION__, "\123\x54\x4f\120\xd\12"); goto yc9n0; rMdqQ: $logs->write(__FUNCTION__, "\x53\124\x41\x52\124"); goto E43js; GCcy6: $logs = new Logs(Arr::last(explode("\134", get_class())) . "\114\x6f\147"); goto rMdqQ; jxM_A: if (!$request->has("\x6e\x6f\144\x61\x74\x61")) { goto zB9hm; } goto rECEM; yc9n0: return DataTables::of($results)->escapeColumns()->addIndexColumn()->toJson(); goto cxr5T; rECEM: return DataTables::of([])->toJson(); goto p0Wyx; p0Wyx: zB9hm: goto GCcy6; cxr5T: } public function store() { } public function show(string $id) : JsonResponse { return response()->json($id, 200); } public function update() { } public function destroy(string $id) : JsonResponse { } public function ExportXLS(Request $request) { goto m3c18; lJWeB: $logs->write(__FUNCTION__, "\x53\124\101\122\x54"); goto BYZbz; v_mzw: dTxiT: goto gQ_Dw; r7yJg: if (!($q < count($queries))) { goto dTxiT; } goto vivC3; vivC3: $sql = Str::replaceArray("\x3f", $queries[$q]["\142\151\156\144\x69\x6e\x67\163"], str_replace("\x3f", "\47\77\x27", $queries[$q]["\161\165\x65\x72\x79"])); goto BKyPR; BaGCS: goto fybzJ; goto v_mzw; m3c18: $logs = new Logs(Arr::last(explode("\134", get_class())) . "\114\157\147"); goto lJWeB; rycUh: $q++; goto BaGCS; gQ_Dw: $logs->write(__FUNCTION__, "\x53\124\117\120\15\12"); goto MxZfT; MxZfT: return Excel::download(new VisitorsReportExport($results), "\114\x61\x70\x6f\x72\141\156\137\102\x61\x63\x61\137\102\x75\x6b\165\x2e\170\154\x73\170"); goto iVSEM; p9cvd: $q = 0; goto PF51W; e8xqS: $queries = DB::getQueryLog(); goto p9cvd; BKyPR: $logs->write("\102\x49\x4e\x44\111\x4e\107", "\x5b" . implode("\x2c\40", $queries[$q]["\x62\151\x6e\144\151\x6e\147\x73"]) . "\x5d"); goto X0fiF; HWEtg: BfHP7: goto rycUh; PF51W: fybzJ: goto r7yJg; BYZbz: $results = []; goto rUrDn; X0fiF: $logs->write("\x53\x51\114", $sql); goto HWEtg; rUrDn: try { goto fBV1Z; Ze9Br: $filter["\x57\114"] = $request->WL ?? ''; goto dYeMW; lYmQZ: $filter["\113\x41\x42\x55\120\101\124\105\116"] = $request->KABUPATEN ?? ''; goto Ze9Br; dYeMW: $filter["\123\x54\x41\x52\x54\x5f\104\x41\124\x45"] = $request->START_DATE ?? ''; goto P0YTU; R5no7: $this->visitors_service->get($filter)->map(function ($value, $i) use(&$results) { goto kI6uO; VLxiT: $results[$i]["\160\x72\157\x76\151\x6e\163\151\x5f\156\x61\155\x65"] = $value->provinsi_name; goto IQxxD; IQxxD: $results[$i]["\153\141\x62\165\x70\141\x74\145\156\x5f\156\x61\155\x65"] = $value->kabupaten_name; goto jBkeD; jBkeD: $results[$i]["\166\x69\x73\151\x74\157\x72"] = $value->visitor; goto v5imU; kI6uO: $results[$i]["\167\x6c\x5f\x6e\x61\155\x65"] = $value->wl_name; goto VLxiT; v5imU: }); goto zAjaL; P0YTU: $filter["\105\116\104\137\104\x41\x54\105"] = $request->END_DATE ?? ''; goto R5no7; fBV1Z: DB::enableQueryLog(); goto oXBC3; oXBC3: $filter["\x50\x52\117\126\111\116\x53\111"] = $request->PROVINSI ?? ''; goto lYmQZ; zAjaL: } catch (\Exception $e) { $logs->write("\105\122\x52\117\122", $e->getMessage()); } goto e8xqS; iVSEM: } }
