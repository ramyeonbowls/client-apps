<?php
/*   __________________________________________________
    |  Obfuscated by Tarmun - Php Obfuscator  2.0.14  |
    |              on 2024-11-23 17:36:13             |
    |                                                 |
    |_________________________________________________|
*/
 namespace App\Http\Controllers\Core\Report; use App\Logs; use Exception; use Throwable; use Carbon\Carbon; use Illuminate\Support\Arr; use Illuminate\Support\Str; use Illuminate\Http\Request; use Illuminate\Http\JsonResponse; use Illuminate\Support\Facades\DB; use App\Http\Controllers\Controller; use Maatwebsite\Excel\Facades\Excel; use App\Exports\Report\QuizReportExport; use App\Services\Report\QuizReportService; use Yajra\DataTables\Facades\DataTables; class QuizReportController extends Controller { private QuizReportService $loans_service; public function __construct() { $this->middleware("\141\165\x74\x68"); $this->loans_service = new QuizReportService(); } public function index(Request $request) : JsonResponse { goto MSp18; q6YIM: return DataTables::of($results)->escapeColumns()->addIndexColumn()->toJson(); goto j_T4b; DJyKD: $results = []; goto LSTjG; MSp18: if (!$request->has("\156\x6f\144\x61\164\141")) { goto nyiR1; } goto ptwaM; LSTjG: try { goto Hy4_K; fxDOc: $filter["\143\x72\145\141\164\145\x64\137\x62\171"] = $user->email; goto oPXN1; yGwf1: $filter["\x57\x4c"] = $request->WL ?? ''; goto L5rBD; K3KW2: $filter["\x45\x4e\x44\137\x44\101\x54\x45"] = $request->END_DATE ?? ''; goto fxDOc; CQpeJ: $sql = Str::replaceArray("\77", $queries[$q]["\142\151\x6e\144\x69\x6e\x67\163"], str_replace("\77", "\x27\77\47", $queries[$q]["\161\x75\145\162\x79"])); goto Z4lCc; VIqYz: $filter["\x4b\101\102\x55\x50\101\124\105\116"] = $request->KABUPATEN ?? ''; goto yGwf1; L5rBD: $filter["\123\124\101\122\124\x5f\x44\101\x54\x45"] = $request->START_DATE ?? ''; goto K3KW2; Y9wnP: $filter["\120\x52\117\x56\x49\116\x53\x49"] = $request->PROVINSI ?? ''; goto VIqYz; omZB0: goto TST1l; goto RK2Lh; yOFsU: if (!($q < count($queries))) { goto rxJzw; } goto CQpeJ; F84pm: TST1l: goto yOFsU; Yh43G: $q++; goto omZB0; Z4lCc: $logs->write("\x42\111\x4e\104\111\x4e\x47", "\133" . implode("\54\40", $queries[$q]["\x62\x69\156\144\151\156\147\163"]) . "\135"); goto O_Jzj; oPXN1: $results = $this->loans_service->get($filter); goto AJ33U; Hy4_K: DB::enableQueryLog(); goto Y9wnP; AJ33U: $queries = DB::getQueryLog(); goto T2prp; Nhyuz: O_TMk: goto Yh43G; T2prp: $q = 0; goto F84pm; RK2Lh: rxJzw: goto zyNJX; O_Jzj: $logs->write("\x53\x51\x4c", $sql); goto Nhyuz; zyNJX: } catch (Throwable $th) { $logs->write("\x45\122\x52\117\x52", $th->getMessage()); } goto F0XhW; F0XhW: $logs->write(__FUNCTION__, "\123\124\117\x50\15\xa"); goto q6YIM; AVPRq: $logs->write(__FUNCTION__, "\123\x54\x41\122\124"); goto A8utR; ECeIN: nyiR1: goto oc4mB; A8utR: $user = auth()->user(); goto DJyKD; ptwaM: return DataTables::of([])->toJson(); goto ECeIN; oc4mB: $logs = new Logs(Arr::last(explode("\x5c", get_class())) . "\114\157\147"); goto AVPRq; j_T4b: } public function store() { } public function show(string $id) : JsonResponse { return response()->json($id, 200); } public function update() { } public function destroy(string $id) : JsonResponse { } public function ExportXLS(Request $request) { goto cLV6y; t99LZ: $logs->write("\x42\111\x4e\x44\111\x4e\x47", "\133" . implode("\54\x20", $queries[$q]["\x62\x69\156\x64\x69\x6e\147\x73"]) . "\135"); goto rDf1U; bp341: iH4tW: goto UeewR; hW_NG: $logs->write(__FUNCTION__, "\123\124\117\120\15\12"); goto xHpQE; rozUV: W1rKj: goto hW_NG; cLV6y: $logs = new Logs(Arr::last(explode("\134", get_class())) . "\x4c\157\x67"); goto kuHiL; PxH3L: $sql = Str::replaceArray("\x3f", $queries[$q]["\x62\x69\x6e\144\151\x6e\147\x73"], str_replace("\77", "\x27\77\x27", $queries[$q]["\x71\165\145\x72\171"])); goto t99LZ; xHpQE: return Excel::download(new QuizReportExport($results), "\114\141\x70\157\x72\x61\156\x5f\x42\x61\143\141\137\102\x75\153\165\56\170\x6c\163\x78"); goto Ki6r0; qS9o6: try { goto u4SBv; ObFgT: $filter["\120\122\x4f\x56\111\116\123\111"] = $request->PROVINSI ?? ''; goto ZbCdl; iWDUY: $filter["\x57\114"] = $request->WL ?? ''; goto mCveY; o_7eT: $filter["\x45\x4e\104\137\x44\x41\124\105"] = $request->END_DATE ?? ''; goto RUTk4; u4SBv: DB::enableQueryLog(); goto ObFgT; RUTk4: $this->loans_service->get($filter)->map(function ($value, $i) use(&$results) { goto cqQs1; cESsg: $results[$i]["\x74\147\x6c"] = $value->tgl; goto PxQGC; p9utv: $results[$i]["\x74\x69\164\154\145"] = $value->title; goto z1_gL; HVPQU: $results[$i]["\x70\162\157\166\151\156\163\151\137\x6e\141\155\145"] = $value->provinsi_name; goto Y3jT2; z1_gL: $results[$i]["\x70\157\x69\x6e\164"] = $value->point; goto cESsg; cqQs1: $results[$i]["\167\154\137\x6e\x61\x6d\145"] = $value->wl_name; goto HVPQU; Y3jT2: $results[$i]["\x6b\141\142\x75\x70\x61\164\145\x6e\137\156\141\155\x65"] = $value->kabupaten_name; goto dQqW1; dQqW1: $results[$i]["\156\141\155\145"] = $value->name; goto p9utv; PxQGC: }); goto d2Wa7; ZbCdl: $filter["\x4b\101\x42\125\120\x41\124\105\x4e"] = $request->KABUPATEN ?? ''; goto iWDUY; mCveY: $filter["\x53\124\x41\122\x54\137\104\x41\x54\105"] = $request->START_DATE ?? ''; goto o_7eT; d2Wa7: } catch (\Exception $e) { $logs->write("\105\122\122\117\x52", $e->getMessage()); } goto sdif7; UeewR: $q++; goto tcxQ8; kuHiL: $logs->write(__FUNCTION__, "\123\124\x41\122\124"); goto IwKmq; Qd33N: if (!($q < count($queries))) { goto W1rKj; } goto PxH3L; IwKmq: $results = []; goto qS9o6; nhin7: vaiiT: goto Qd33N; XNxvi: $q = 0; goto nhin7; rDf1U: $logs->write("\x53\x51\x4c", $sql); goto bp341; tcxQ8: goto vaiiT; goto rozUV; sdif7: $queries = DB::getQueryLog(); goto XNxvi; Ki6r0: } public function detail(Request $request) : JsonResponse { goto eUsqK; zw6rL: try { goto DsExA; rEIvz: GMknF: goto jE2ed; nYnqz: $filter["\127\114"] = $request->WL ?? ''; goto ZQmcD; lfToJ: FSQrO: goto vpgnY; KilEA: $q = 0; goto dGrLh; vpgnY: $q++; goto nPC5d; fmD3L: $quizq = $this->loans_service->getQuestion($filter); goto vBKgk; ELpKW: $queries = DB::getQueryLog(); goto KilEA; DsExA: DB::enableQueryLog(); goto db5hW; dGrLh: EKBKQ: goto ivwSx; P5f1E: $filter["\163\165\162\166\x65\171\x5f\151\144"] = $request->survey_id ?? ''; goto o_q0l; ZQmcD: $filter["\151\x64"] = $request->id ?? ''; goto VTw7W; W2LJw: NDl_q: goto ELpKW; mrVT9: $sql = Str::replaceArray("\x3f", $queries[$q]["\x62\151\x6e\144\x69\156\147\x73"], str_replace("\x3f", "\x27\x3f\47", $queries[$q]["\x71\x75\x65\162\x79"])); goto sj1Oi; db5hW: $filter["\120\122\x4f\126\x49\x4e\123\x49"] = $request->PROVINSI ?? ''; goto zdWeH; VTw7W: $filter["\144\141\164\145"] = $request->date ?? ''; goto P5f1E; sj1Oi: $logs->write("\102\x49\x4e\104\111\116\x47", "\133" . implode("\x2c\40", $queries[$q]["\142\151\x6e\144\x69\156\x67\163"]) . "\135"); goto Sd8JD; vBKgk: foreach ($quizq as $i => $question) { goto EXINa; TGezu: $results["\161\165\145\x73\x74\151\x6f\x6e\163"][$i]["\x64\x65\x73\143\x72\151\160\x74\151\157\x6e"] = $question->description; goto dnahv; dF1cB: $results["\161\x75\x65\163\164\x69\x6f\156\x73"][$i]["\141\156\x73\x77\x65\x72"] = []; goto xjnXN; cT_Fe: foreach ($rst as $iii => $answer) { goto L9R89; qkH04: aEBiS: goto O4pQo; navj3: $results["\161\165\145\x73\x74\151\157\x6e\163"][$i]["\x61\x6e\163\x77\x65\x72"][$iii]["\144\145\x73\x63\x72\151\160\x74\x69\x6f\156"] = $answer->description; goto tb_iv; L9R89: $results["\x71\165\x65\x73\x74\x69\157\x6e\163"][$i]["\x61\156\163\167\145\x72"][$iii]["\151\x64"] = $answer->answer_id; goto navj3; tb_iv: $results["\161\165\x65\x73\x74\x69\157\x6e\163"][$i]["\x61\x6e\163\x77\x65\x72"][$iii]["\x70\157\x69\156\164"] = $answer->point; goto qkH04; O4pQo: } goto fsfjF; EXINa: $results["\161\165\x65\x73\164\x69\x6f\156\163"][$i]["\151\144"] = $question->id; goto TGezu; dnahv: $results["\161\165\145\163\164\x69\x6f\156\x73"][$i]["\164\x65\155\x70\154\141\164\145\x5f\x73\145\x71\x75\145\156\x63\x65"] = $question->seq; goto ueeFi; xjnXN: $rst = $this->loans_service->getAnswer($filter, $question->id); goto cT_Fe; ueeFi: $results["\x71\165\x65\x73\x74\x69\157\156\x73"][$i]["\162\x65\161\x75\x69\162\145\144"] = (bool) $question->required; goto Wutep; VA4YW: $results["\x71\165\145\163\164\x69\157\x6e\163"][$i]["\x70\157\x69\156\164"] = $question->point; goto dF1cB; Wutep: $results["\161\x75\x65\163\x74\151\157\156\163"][$i]["\x74\x79\x70\145"] = $question->type; goto VA4YW; fsfjF: ycuH6: goto JkOA8; JkOA8: oe5Ur: goto VIUhQ; VIUhQ: } goto W2LJw; zdWeH: $filter["\113\x41\102\125\120\101\x54\105\116"] = $request->KABUPATEN ?? ''; goto nYnqz; o_q0l: $results["\161\165\145\x73\x74\151\x6f\x6e\163"] = []; goto fmD3L; nPC5d: goto EKBKQ; goto rEIvz; Sd8JD: $logs->write("\123\x51\x4c", $sql); goto lfToJ; ivwSx: if (!($q < count($queries))) { goto GMknF; } goto mrVT9; jE2ed: } catch (Throwable $th) { $logs->write("\x45\x52\x52\117\x52", $th->getMessage()); } goto C8uON; eUsqK: $logs = new Logs(Arr::last(explode("\134", get_class())) . "\114\x6f\147"); goto riIPY; C8uON: $logs->write(__FUNCTION__, "\x53\x54\117\x50\15\xa"); goto gIqLL; gIqLL: return response()->json($results, 200); goto BKlKh; krQYt: $results = []; goto zw6rL; riIPY: $logs->write(__FUNCTION__, "\x53\124\101\x52\124"); goto krQYt; BKlKh: } }
