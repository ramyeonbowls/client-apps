<?php
/*   __________________________________________________
    |  Obfuscated by Tarmun - Php Obfuscator  2.0.14  |
    |              on 2024-11-18 10:11:20             |
    |                                                 |
    |_________________________________________________|
*/
 namespace App\Http\Controllers; use App\Logs; use Carbon\Carbon; use Illuminate\Support\Arr; use Illuminate\Support\Str; use Illuminate\Http\Request; use Illuminate\Support\Facades\DB; class QuizTransactionController extends Controller { protected $client_id = ''; public function __construct() { $this->middleware("\141\x75\164\150"); $this->client_id = config("\141\160\x70\56\143\154\x69\x65\156\x74\137\151\x64", ''); } public function index() { goto vSQCn; vSQCn: $logs = new Logs(Arr::last(explode("\x5c", get_class())) . "\114\157\x67"); goto tQ_Sr; wgoAN: EP_Wq: goto KXHH8; tVCcP: $logs->write("\102\x49\x4e\x44\111\x4e\107", "\133" . implode("\54\40", $queries[$q]["\142\151\156\144\x69\x6e\147\163"]) . "\x5d"); goto pKboK; d7TMZ: $q++; goto qEOVs; lI0T7: $results = DB::table("\164\x71\165\x69\x7a\x5f\150\40\141\x73\x20\x61")->select(["\141\56\x69\144", "\x61\x2e\x74\151\x74\154\x65", "\x61\56\x64\x65\163\x63\162\x69\x70\x74\x69\x6f\x6e", "\x61\x2e\x73\164\141\x72\x74\x5f\x64\141\164\x65", "\x61\56\145\156\144\x5f\x64\x61\164\x65", "\142\x2e\156\141\x6d\145"])->join("\165\x73\145\162\x73\40\x61\163\x20\x62", function ($join) { $join->on("\x61\x2e\x63\154\x69\145\x6e\164\x5f\151\x64", "\75", "\142\56\x63\x6c\x69\x65\x6e\x74\x5f\151\x64")->on("\x61\x2e\143\x72\145\141\x74\x65\144\137\x62\x79", "\x3d", "\x62\x2e\x65\155\141\151\154"); })->where("\141\x2e\143\x6c\151\145\156\x74\x5f\x69\x64", "\x3d", $this->client_id)->whereRaw("\x43\117\x4e\126\105\122\124\x28\x4e\x4f\127\x28\51\54\x20\x44\101\x54\x45\x29\40\102\x45\x54\x57\105\x45\x4e\x20\x61\x2e\x73\x74\x61\162\164\137\144\141\164\x65\x20\x41\116\104\x20\x61\56\x65\156\144\137\x64\x61\x74\x65")->orderBy("\x61\56\x63\x72\x65\x61\x74\x65\144\x5f\x61\164", "\x44\x45\123\x43")->get()->map(function ($value) use($user) { goto N1E3O; p6jgd: return ["\151\x64" => $value->id, "\x74\x69\164\x6c\x65" => $value->title, "\144\x65\x73\x63\162\x69\x70\164\x69\157\x6e" => $value->description, "\163\x74\141\162\164\x5f\x64\x61\164\145" => $value->start_date, "\x65\156\x64\x5f\144\141\x74\145" => $value->end_date, "\146\x69\156\x69\x73\x68\x65\x64" => $finished, "\156\x61\x6d\145" => $value->name]; goto ISlxQ; trbbg: $finished = $cek_nilai->finished > 0 ? true : false; goto p6jgd; ioUww: $nilai = $cek_nilai->nilai; goto trbbg; N1E3O: $cek_nilai = $this->getResult($this->client_id, $value->id, $user->id); goto ioUww; ISlxQ: }); goto QtHeV; g4TWK: kKKun: goto d7TMZ; GpBGg: DB::enableQueryLog(); goto USd99; USd99: $user = auth()->user(); goto lI0T7; iHroy: $sql = Str::replaceArray("\77", $queries[$q]["\x62\151\x6e\x64\x69\156\x67\x73"], str_replace("\77", "\47\x3f\x27", $queries[$q]["\x71\165\x65\162\x79"])); goto tVCcP; pKboK: $logs->write("\123\121\x4c", $sql); goto g4TWK; QtHeV: $queries = DB::getQueryLog(); goto QVSBq; KXHH8: if (!($q < count($queries))) { goto kb1KQ; } goto iHroy; qEOVs: goto EP_Wq; goto LaB0N; qHNCY: return response()->json($results, 200); goto F8Rcb; LaB0N: kb1KQ: goto qHNCY; tQ_Sr: $logs->write(__FUNCTION__, "\123\x54\x41\x52\x54"); goto GpBGg; QVSBq: $q = 0; goto wgoAN; F8Rcb: } public function getDetailQuiz(Request $request) { goto CCKI2; he188: I0ICn: goto NLAMd; e9ULq: $results["\x6e\151\154\x61\x69"] = $cek_nilai->nilai; goto lcCTg; DiLXV: return response()->json($results, 200); goto Bm8Fi; imigm: $logs->write("\x53\121\x4c", $sql); goto AYitc; AYitc: Q3G23: goto Ae7xJ; T3aEO: $sql = Str::replaceArray("\77", $queries[$q]["\x62\151\x6e\x64\151\x6e\x67\163"], str_replace("\x3f", "\x27\x3f\x27", $queries[$q]["\161\x75\145\162\x79"])); goto stc2s; lcCTg: $results["\146\151\156\x69\163\150\145\144"] = $cek_nilai->finished > 0 ? true : false; goto iIIqs; wZ406: $results["\161\165\145\x73\164\151\157\x6e\x73"] = []; goto KtMHo; EvxBw: DB::enableQueryLog(); goto vDb0t; Oa5IQ: $q = 0; goto he188; stc2s: $logs->write("\102\111\x4e\104\111\116\x47", "\133" . implode("\54\40", $queries[$q]["\x62\151\x6e\x64\x69\156\147\x73"]) . "\x5d"); goto imigm; KtMHo: $quizq = DB::table("\x74\161\x75\x69\x7a\137\x71\165\x65\163\164\x69\x6f\x6e\x20\x61\x73\x20\x61")->select("\141\x2e\52")->where("\141\56\143\x6c\151\145\x6e\x74\137\151\144", "\75", $this->client_id)->where("\141\56\x73\165\162\166\145\171\137\151\144", "\75", $request->id)->get(); goto Ns_0r; Ae7xJ: $q++; goto tzV98; iIIqs: foreach ($quizq as $i => $question) { goto SOk9r; F3tPA: cSvzY: goto qBEQR; gAbvr: $quiza = DB::table("\164\161\165\151\172\137\x61\x6e\x73\x77\145\x72\x20\141\x73\40\141")->select("\141\56\52")->where("\x61\56\143\x6c\x69\145\x6e\164\137\x69\x64", "\x3d", $this->client_id)->where("\141\56\x73\x75\162\x76\145\171\137\151\144", "\x3d", $request->id)->where("\141\56\x71\x75\145\163\x74\151\x6f\x6e\x5f\151\144", "\75", $question->id)->get(); goto Puf_m; b0k3r: $results["\x71\165\145\x73\164\151\157\156\x73"][$i]["\x74\x79\x70\145"] = $question->type; goto A0DFh; CXTQ1: $results["\x71\165\x65\x73\164\151\157\156\x73"][$i]["\164\145\155\160\154\141\164\x65\137\x73\145\161\165\145\156\x63\x65"] = $question->seq; goto oZEFh; MhfU0: goto o3isj; goto F3tPA; SOk9r: $results["\161\165\145\x73\164\x69\x6f\x6e\x73"][$i]["\151\x64"] = $question->id; goto iCOIA; xTiu2: $results["\x71\165\x65\x73\x74\x69\x6f\x6e\163"][$i]["\x61\x6e\x73\167\x65\162"] = []; goto D70Tb; iCOIA: $results["\x71\x75\145\x73\164\x69\x6f\x6e\163"][$i]["\x64\145\163\143\x72\151\x70\x74\x69\157\156"] = $question->description; goto CXTQ1; BXd2P: UypDF: goto cCNja; Obe73: uZbE3: goto MhfU0; Puf_m: foreach ($quiza as $ii => $answer) { goto flasE; iQNZw: $results["\161\165\x65\x73\x74\151\x6f\156\163"][$i]["\x61\156\x73\167\145\x72"][$ii]["\x70\x6f\151\156\164"] = $answer->point; goto H1kpr; Hk9Is: $results["\161\x75\x65\x73\164\x69\x6f\156\x73"][$i]["\x61\x6e\163\x77\145\x72"][$ii]["\144\145\x73\x63\162\151\x70\x74\151\157\156"] = $answer->description; goto iQNZw; H1kpr: Z0zl1: goto V4uMZ; flasE: $results["\161\165\x65\163\164\x69\157\x6e\x73"][$i]["\141\x6e\x73\x77\x65\x72"][$ii]["\x69\144"] = $answer->id; goto Hk9Is; V4uMZ: } goto Obe73; oZEFh: $results["\x71\165\145\x73\x74\x69\157\x6e\x73"][$i]["\162\x65\161\165\x69\162\145\x64"] = (bool) $question->required; goto b0k3r; pAQlX: RlNft: goto zk6zD; qBEQR: $rst = DB::table("\164\161\x75\151\x7a\x5f\x74\162\x78\x20\141\x73\x20\x61")->select("\x61\56\52", "\x62\x2e\x64\x65\x73\143\162\x69\160\x74\151\x6f\x6e", "\142\56\160\157\151\x6e\164")->leftjoin("\x74\161\165\x69\172\x5f\x61\x6e\163\x77\x65\x72\x20\141\163\x20\x62", function ($join) { $join->on("\141\56\x63\154\x69\x65\x6e\x74\137\151\144", "\x3d", "\142\56\x63\154\151\145\x6e\164\137\151\x64")->on("\141\56\x73\x75\x72\x76\x65\171\x5f\151\x64", "\x3d", "\x62\x2e\163\x75\162\166\145\171\x5f\x69\144")->on("\x61\56\161\165\145\x73\164\151\157\x6e\137\151\144", "\x3d", "\x62\x2e\x71\x75\x65\x73\164\151\157\156\137\x69\144")->on("\141\56\x61\156\163\167\145\x72\137\x69\144", "\x3d", "\x62\x2e\151\x64"); })->where("\141\x2e\143\x6c\151\145\156\x74\137\x69\x64", "\x3d", $this->client_id)->where("\x61\56\163\x75\x72\x76\x65\171\137\x69\144", "\75", $request->id)->where("\141\56\x75\x73\x65\x72\x5f\151\x64", "\x3d", $user->id)->where("\x61\x2e\161\x75\x65\163\164\151\157\156\x5f\151\144", "\75", $question->id)->get(); goto IYy5R; IYy5R: foreach ($rst as $iii => $answer) { goto b12v6; wpADx: Qhhhf: goto hqbCG; b12v6: $results["\x71\x75\145\x73\x74\151\x6f\156\163"][$i]["\x61\x6e\x73\167\145\x72"][$iii]["\x69\x64"] = $answer->answer_id; goto jHz8_; jHz8_: $results["\161\165\x65\x73\x74\x69\157\156\163"][$i]["\x61\156\x73\x77\x65\x72"][$iii]["\x64\145\x73\143\x72\x69\x70\x74\151\x6f\156"] = $answer->description; goto pZxCV; pZxCV: $results["\161\165\x65\x73\164\151\157\x6e\163"][$i]["\141\x6e\163\x77\x65\x72"][$iii]["\160\157\151\156\164"] = $answer->point; goto wpADx; hqbCG: } goto pAQlX; A0DFh: $results["\161\165\x65\x73\x74\x69\x6f\156\x73"][$i]["\160\157\151\x6e\x74"] = $question->point; goto xTiu2; D70Tb: if ($results["\x66\x69\x6e\x69\163\150\x65\x64"]) { goto cSvzY; } goto gAbvr; zk6zD: o3isj: goto BXd2P; cCNja: } goto MwgbQ; cX83o: $queries = DB::getQueryLog(); goto Oa5IQ; MwgbQ: NfAWI: goto cX83o; Ns_0r: $cek_nilai = $this->getResult($this->client_id, $request->id, $user->id); goto e9ULq; XiS5s: $logs->write(__FUNCTION__, "\x53\124\101\122\124"); goto EvxBw; NLAMd: if (!($q < count($queries))) { goto Ni0kv; } goto T3aEO; VJbx6: Ni0kv: goto DiLXV; CCKI2: $logs = new Logs(Arr::last(explode("\134", get_class())) . "\x4c\x6f\x67"); goto XiS5s; KB1We: $results["\150\x65\x61\144\x65\162"] = DB::table("\x74\x71\165\x69\172\x5f\150\40\141\163\40\141")->select(["\141\56\x69\x64", "\141\x2e\x74\151\x74\x6c\145", "\x61\x2e\144\145\x73\x63\x72\x69\x70\164\x69\x6f\156", "\x61\56\x73\164\x61\x72\x74\x5f\144\x61\164\145", "\141\x2e\x65\156\144\x5f\x64\x61\x74\x65", "\142\56\x6e\141\x6d\145"])->join("\x75\163\x65\162\x73\x20\141\x73\40\x62", function ($join) { $join->on("\x61\x2e\x63\x6c\151\145\x6e\164\x5f\151\x64", "\75", "\142\56\143\x6c\151\x65\x6e\x74\137\151\x64")->on("\x61\x2e\143\x72\145\x61\x74\145\144\x5f\x62\x79", "\x3d", "\142\x2e\145\x6d\x61\151\x6c"); })->where("\141\56\x63\x6c\151\145\156\164\137\x69\144", "\75", $this->client_id)->where("\x61\x2e\x69\x64", "\x3d", $request->id)->orderBy("\141\56\143\162\145\x61\164\145\x64\x5f\141\164", "\x44\x45\x53\x43")->get()->map(function ($value) { return ["\x69\144" => $value->id, "\x74\151\x74\154\x65" => $value->title, "\x64\145\163\x63\x72\x69\x70\x74\151\x6f\156" => $value->description, "\163\x74\141\x72\164\x5f\144\141\164\145" => $value->start_date, "\145\x6e\144\x5f\144\141\x74\145" => $value->end_date, "\x6e\141\155\x65" => $value->name]; }); goto wZ406; tzV98: goto I0ICn; goto VJbx6; vDb0t: $user = auth()->user(); goto KB1We; Bm8Fi: } public function store(Request $request) { goto FfSUe; Ds6pi: try { goto R23Va; PLKaT: $logs->write(__FUNCTION__, "\123\x54\x4f\120\xd\xa"); goto kPhr9; EULQO: $q = 0; goto VQGEd; S9sXf: FrwIN: goto T2ISo; YygGN: goto Plpaw; goto JbWz2; CLxMS: return response()->json("\102\x65\162\150\x61\163\x69\x6c\x20\155\x65\156\x79\151\x6d\x70\x61\156\40\152\141\x77\141\x62\x61\156\40\x6b\165\151\x73\56", 201); goto S9sXf; ilLPX: eBzP4: goto wujab; Z363E: foreach ($request->answers as $key => $value) { goto e3dQr; KFhwP: COz2S: goto D5UYJ; HcjrQ: Rqr5Q: goto KFhwP; i123O: $success = false; goto HcjrQ; W7ZXX: if ($insert) { goto Rqr5Q; } goto i123O; e3dQr: $insert = DB::table("\x74\x71\165\151\x7a\137\x74\162\x78")->insert(["\x63\154\x69\145\156\x74\x5f\x69\144" => $this->client_id, "\x75\163\x65\162\x5f\151\144" => $user->id, "\x73\x75\162\166\145\171\137\x69\144" => $quiz_id, "\161\165\145\x73\164\151\157\156\137\151\x64" => $value["\x71\165\145\163\x74\151\157\156\x49\x64"], "\141\x6e\x73\167\x65\x72\x5f\x69\x64" => $value["\163\x65\154\145\x63\164\x65\144\x41\x6e\x73\x77\145\162"], "\164\171\x70\x65" => $value["\x74\x79\160\145"], "\160\x6f\151\x6e\x74" => $value["\x61\x6e\x73\167\145\x72\x50\157\x69\156\x74"], "\143\162\145\x61\164\145\x64\137\141\x74" => Carbon::now("\x41\x73\151\x61\x2f\112\x61\x6b\141\162\164\141")]); goto W7ZXX; D5UYJ: } goto ilLPX; NY2Ui: $logs->write("\102\x49\116\104\111\x4e\107", "\x5b" . implode("\x2c\40", $queries[$q]["\x62\151\x6e\x64\x69\x6e\147\x73"]) . "\x5d"); goto jxSOD; Hgyd9: $success = true; goto WaLUE; AY_89: V79OG: goto Q_Gs3; Q_Gs3: \DB::commit(); goto gsO6E; cYdTf: $logs->write("\x45\x52\122\x4f\x52", "\x52\117\x4c\x4c\x42\101\103\x4b"); goto PLKaT; jxSOD: $logs->write("\x53\121\x4c", $sql); goto m66h_; pFlvO: $logs->write(__FUNCTION__, "\123\x54\117\120\15\xa"); goto CLxMS; gsO6E: $logs->write("\123\125\x43\x43\x45\x53\x53", "\x43\x4f\115\x4d\111\124"); goto pFlvO; JbWz2: Cq1r5: goto v9ERN; R23Va: DB::enableQueryLog(); goto fVe1E; kPhr9: return response()->json("\x47\141\x67\x61\x6c\40\x6d\145\156\x79\151\155\x70\141\x6e\x20\x6a\x61\x77\x61\142\x61\x6e\40\x6b\165\x69\163\x2e", 500); goto VPljb; spraR: if (!($q < count($queries))) { goto Cq1r5; } goto Squxb; bbu_R: \DB::rollBack(); goto cYdTf; VPljb: goto FrwIN; goto AY_89; fVe1E: \DB::beginTransaction(); goto Hgyd9; VQGEd: Plpaw: goto spraR; WaLUE: $quiz_id = $request->id; goto Z363E; m66h_: U_fJO: goto Ctgfa; Ctgfa: $q++; goto YygGN; v9ERN: if ($success) { goto V79OG; } goto bbu_R; Squxb: $sql = Str::replaceArray("\77", $queries[$q]["\x62\x69\x6e\x64\151\156\x67\163"], str_replace("\x3f", "\47\x3f\x27", $queries[$q]["\161\x75\145\x72\x79"])); goto NY2Ui; wujab: $queries = DB::getQueryLog(); goto EULQO; T2ISo: } catch (\Exception $e) { goto DWyfN; sqiHo: return response()->json("\107\x61\x67\141\154\40\x6d\145\156\171\x69\x6d\x70\141\x6e\x20\152\x61\x77\x61\x62\141\x6e\40\153\x75\151\163\56", 500); goto PWaqY; DWyfN: $logs->write("\105\122\122\x4f\122", $e->getMessage()); goto ee5VA; ee5VA: \DB::rollBack(); goto sqiHo; PWaqY: } goto EWp3R; PVQ2t: $user = auth()->user(); goto aA13B; aA13B: $logs = new Logs(Arr::last(explode("\x5c", get_class())) . "\114\157\x67"); goto TPEC4; TPEC4: $logs->write(__FUNCTION__, "\123\124\101\x52\x54"); goto Ds6pi; FfSUe: Carbon::setLocale("\x69\144"); goto PVQ2t; EWp3R: } private function getResult($client_id, $survey_id, $user_id) { return DB::table("\164\161\165\x69\x7a\137\x74\x72\x78\40\x61\163\x20\x61")->select(DB::raw("\x53\125\115\x28\141\56\x70\157\x69\156\x74\x29\x20\x61\x73\x20\156\x69\x6c\x61\151"), DB::raw("\103\117\x55\x4e\124\50\x61\x2e\x71\x75\x65\x73\164\x69\x6f\156\137\151\144\x29\x20\x61\163\40\146\x69\156\x69\163\x68\145\x64"))->where("\x61\x2e\x63\x6c\x69\145\156\x74\x5f\151\x64", "\75", $client_id)->where("\x61\56\163\165\x72\166\x65\x79\137\x69\x64", "\x3d", $survey_id)->where("\x61\x2e\165\x73\145\x72\x5f\151\144", "\x3d", $user_id)->first(); } }
