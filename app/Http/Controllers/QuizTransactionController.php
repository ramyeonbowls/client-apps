<?php
/*   __________________________________________________
    |  Obfuscated by Tarmun - Php Obfuscator  2.0.14  |
    |              on 2024-11-23 17:36:14             |
    |                                                 |
    |_________________________________________________|
*/
 namespace App\Http\Controllers; use App\Logs; use Carbon\Carbon; use Illuminate\Support\Arr; use Illuminate\Support\Str; use Illuminate\Http\Request; use Illuminate\Support\Facades\DB; class QuizTransactionController extends Controller { protected $client_id = ''; public function __construct() { $this->middleware("\141\x75\164\x68"); $this->client_id = config("\141\160\x70\x2e\143\x6c\151\x65\156\x74\137\151\144", ''); } public function index() { goto McQB0; O6Fwq: $q++; goto HhEFo; McQB0: $logs = new Logs(Arr::last(explode("\134", get_class())) . "\114\x6f\147"); goto faztp; y0VCk: $logs->write("\x53\121\x4c", $sql); goto f3c1C; VC7lp: $sql = Str::replaceArray("\77", $queries[$q]["\x62\x69\x6e\x64\151\156\147\x73"], str_replace("\x3f", "\47\77\47", $queries[$q]["\x71\165\145\x72\171"])); goto nWmg2; zRrQY: $results = DB::table("\164\x71\165\x69\x7a\137\x68\40\141\x73\x20\141")->select(["\x61\x2e\151\144", "\141\x2e\164\x69\164\154\145", "\x61\x2e\144\145\163\143\162\x69\160\164\151\157\x6e", "\x61\56\163\164\141\162\x74\137\x64\141\x74\145", "\141\56\x65\156\x64\137\x64\141\164\145", "\x62\56\x6e\x61\x6d\x65"])->join("\x75\x73\145\162\x73\40\141\163\x20\x62", function ($join) { $join->on("\141\56\143\x6c\151\x65\156\x74\x5f\x69\x64", "\75", "\142\56\143\x6c\151\x65\x6e\164\137\151\x64")->on("\141\56\x63\162\145\x61\164\x65\144\x5f\142\171", "\75", "\x62\56\145\x6d\x61\151\x6c"); })->where("\x61\56\x63\154\x69\145\x6e\x74\137\x69\144", "\x3d", $this->client_id)->whereRaw("\x43\x4f\x4e\126\105\x52\124\50\116\x4f\x57\50\x29\x2c\x20\104\101\x54\x45\x29\40\102\105\124\x57\105\x45\116\40\141\x2e\x73\x74\x61\162\164\137\144\x61\164\x65\40\x41\116\104\40\141\x2e\145\156\144\x5f\x64\x61\x74\x65")->orderBy("\141\56\143\x72\145\x61\164\x65\144\137\141\164", "\104\x45\x53\x43")->get()->map(function ($value) use($user) { goto A7bmv; YrbYz: $finished = $cek_nilai->finished > 0 ? true : false; goto S70lA; dOz2p: $nilai = $cek_nilai->nilai; goto YrbYz; S70lA: return ["\151\144" => $value->id, "\x74\151\164\x6c\145" => $value->title, "\x64\145\163\143\x72\x69\x70\x74\151\157\156" => $value->description, "\x73\164\x61\162\164\137\144\x61\164\x65" => $value->start_date, "\x65\156\144\x5f\144\x61\x74\x65" => $value->end_date, "\146\x69\x6e\x69\163\x68\145\x64" => $finished, "\x6e\141\x6d\145" => $value->name]; goto IOU4J; A7bmv: $cek_nilai = $this->getResult($this->client_id, $value->id, $user->id); goto dOz2p; IOU4J: }); goto N2i6M; HhEFo: goto xVYOn; goto NK64A; rdw9Z: $user = auth()->user(); goto zRrQY; VAzrv: if (!($q < count($queries))) { goto lMyt9; } goto VC7lp; NK64A: lMyt9: goto g8lFp; g8lFp: return response()->json($results, 200); goto h6XMD; Nt3VS: DB::enableQueryLog(); goto rdw9Z; ip5Wf: xVYOn: goto VAzrv; nWmg2: $logs->write("\x42\x49\x4e\x44\111\116\x47", "\x5b" . implode("\x2c\40", $queries[$q]["\x62\151\156\x64\151\x6e\x67\163"]) . "\x5d"); goto y0VCk; f3c1C: loTUH: goto O6Fwq; N2i6M: $queries = DB::getQueryLog(); goto ljSEo; faztp: $logs->write(__FUNCTION__, "\x53\x54\x41\x52\124"); goto Nt3VS; ljSEo: $q = 0; goto ip5Wf; h6XMD: } public function getDetailQuiz(Request $request) { goto EX5_V; ahfr0: $q = 0; goto QwjLo; QwjLo: SnDUk: goto KPmed; KPmed: if (!($q < count($queries))) { goto UoQNf; } goto n6yyk; IY1bI: $results["\156\151\x6c\141\x69"] = $cek_nilai->nilai; goto T_eEO; jiDWZ: goto SnDUk; goto Rl_8X; W1Dfm: $logs->write(__FUNCTION__, "\123\x54\x41\x52\124"); goto RHcdf; Sya0v: return response()->json($results, 200); goto hCyLW; oq59y: $logs->write("\x53\x51\x4c", $sql); goto xTHVs; Rl_8X: UoQNf: goto Sya0v; xTHVs: RTEqb: goto V5tUA; V5tUA: $q++; goto jiDWZ; T_eEO: $results["\x66\x69\x6e\151\x73\x68\145\144"] = $cek_nilai->finished > 0 ? true : false; goto SRHc9; SRHc9: foreach ($quizq as $i => $question) { goto iSzGx; SAReS: $results["\161\x75\x65\x73\x74\151\157\156\x73"][$i]["\160\157\151\x6e\164"] = $question->point; goto NSCpP; fx4sh: $results["\161\x75\145\x73\164\x69\x6f\156\163"][$i]["\x64\145\x73\x63\x72\x69\x70\x74\151\157\x6e"] = $question->description; goto TSLBW; Zsxje: if ($results["\146\151\x6e\x69\163\150\x65\144"]) { goto yapsD; } goto Oj3Tg; XRt1g: Yh9P9: goto T95Sw; TSLBW: $results["\x71\x75\x65\x73\164\x69\x6f\x6e\163"][$i]["\x74\x65\x6d\160\154\141\x74\x65\137\x73\x65\161\165\x65\x6e\143\145"] = $question->seq; goto CEVfG; IuYck: $rst = DB::table("\x74\x71\x75\151\x7a\137\164\x72\170\40\x61\x73\40\x61")->select("\141\56\x2a", "\x62\x2e\144\x65\x73\143\162\x69\x70\164\x69\x6f\x6e", "\142\56\x70\157\151\156\164")->leftjoin("\x74\161\165\x69\x7a\x5f\x61\x6e\x73\x77\145\x72\40\x61\163\40\x62", function ($join) { $join->on("\x61\56\143\154\x69\145\x6e\164\x5f\151\144", "\x3d", "\x62\56\143\x6c\x69\x65\156\x74\137\x69\x64")->on("\141\x2e\x73\165\x72\x76\x65\x79\x5f\151\144", "\75", "\x62\x2e\x73\165\162\x76\x65\171\137\x69\x64")->on("\x61\x2e\161\165\x65\x73\x74\151\x6f\156\x5f\151\144", "\x3d", "\142\56\x71\x75\145\163\164\x69\x6f\x6e\x5f\x69\144")->on("\141\56\x61\156\x73\167\145\162\137\151\144", "\x3d", "\142\x2e\x69\x64"); })->where("\141\56\x63\154\151\145\x6e\164\x5f\151\144", "\75", $this->client_id)->where("\141\56\x73\x75\x72\x76\x65\171\137\151\x64", "\75", $request->id)->where("\x61\56\x75\x73\145\162\137\x69\x64", "\x3d", $user->id)->where("\x61\x2e\161\165\x65\163\x74\x69\157\156\x5f\151\144", "\75", $question->id)->get(); goto NgIEO; pySF2: goto XIQRN; goto QUvkM; Oj3Tg: $quiza = DB::table("\164\161\x75\151\172\x5f\x61\156\x73\x77\x65\x72\x20\141\x73\40\x61")->select("\141\x2e\52")->where("\x61\56\x63\154\x69\x65\156\164\137\151\x64", "\75", $this->client_id)->where("\141\x2e\163\165\162\166\145\x79\x5f\151\x64", "\75", $request->id)->where("\141\56\x71\x75\145\163\x74\151\157\156\137\151\144", "\75", $question->id)->get(); goto LKGEW; brHnw: cSukN: goto pySF2; iSzGx: $results["\161\x75\x65\x73\164\x69\157\156\163"][$i]["\151\x64"] = $question->id; goto fx4sh; QUvkM: yapsD: goto IuYck; LKGEW: foreach ($quiza as $ii => $answer) { goto CGDa1; ryXTD: $results["\161\x75\145\163\164\151\157\x6e\163"][$i]["\141\156\x73\x77\x65\x72"][$ii]["\x64\x65\163\143\x72\x69\160\x74\x69\157\156"] = $answer->description; goto OMF6C; D18Ds: xmHJL: goto SLNxN; CGDa1: $results["\x71\x75\145\x73\164\151\x6f\x6e\x73"][$i]["\141\156\x73\167\x65\x72"][$ii]["\x69\144"] = $answer->id; goto ryXTD; OMF6C: $results["\161\x75\x65\163\x74\151\157\x6e\163"][$i]["\x61\156\x73\167\x65\162"][$ii]["\x70\x6f\151\156\164"] = $answer->point; goto D18Ds; SLNxN: } goto brHnw; NSCpP: $results["\x71\165\145\163\164\151\157\156\163"][$i]["\141\x6e\163\x77\x65\x72"] = []; goto Zsxje; A6f1C: $results["\161\x75\145\x73\164\151\157\x6e\163"][$i]["\164\x79\x70\x65"] = $question->type; goto SAReS; K2uiL: XIQRN: goto XRt1g; NgIEO: foreach ($rst as $iii => $answer) { goto O7CWa; nnQts: lGWj2: goto m8Q88; jcNPz: $results["\x71\165\x65\163\164\151\157\x6e\x73"][$i]["\141\156\x73\x77\x65\x72"][$iii]["\x70\157\x69\156\x74"] = $answer->point; goto nnQts; PsB_N: $results["\161\x75\145\x73\x74\x69\157\156\x73"][$i]["\141\156\x73\167\x65\x72"][$iii]["\144\x65\163\143\x72\151\x70\x74\x69\x6f\x6e"] = $answer->description; goto jcNPz; O7CWa: $results["\x71\165\x65\x73\x74\151\x6f\x6e\x73"][$i]["\x61\x6e\x73\x77\145\162"][$iii]["\x69\x64"] = $answer->answer_id; goto PsB_N; m8Q88: } goto Mcq1D; CEVfG: $results["\161\165\145\x73\164\x69\x6f\x6e\x73"][$i]["\162\x65\161\x75\151\x72\x65\144"] = (bool) $question->required; goto A6f1C; Mcq1D: FKIF6: goto K2uiL; T95Sw: } goto E7KSe; o3nih: $quizq = DB::table("\x74\161\165\151\x7a\137\x71\165\145\x73\164\151\x6f\x6e\x20\141\x73\40\141")->select("\141\56\52")->where("\141\56\143\154\x69\145\156\164\x5f\x69\x64", "\x3d", $this->client_id)->where("\141\56\163\x75\x72\x76\145\x79\137\x69\x64", "\75", $request->id)->get(); goto zHpDU; oNWzB: $user = auth()->user(); goto HcfBB; EX5_V: $logs = new Logs(Arr::last(explode("\x5c", get_class())) . "\x4c\x6f\x67"); goto W1Dfm; RHcdf: DB::enableQueryLog(); goto oNWzB; n6yyk: $sql = Str::replaceArray("\77", $queries[$q]["\142\x69\156\x64\x69\156\147\163"], str_replace("\x3f", "\x27\x3f\x27", $queries[$q]["\x71\x75\x65\162\x79"])); goto iflky; HcfBB: $results["\150\x65\x61\x64\x65\162"] = DB::table("\x74\x71\x75\151\x7a\137\x68\40\141\163\40\x61")->select(["\141\x2e\151\x64", "\x61\x2e\164\151\164\x6c\145", "\x61\56\x64\145\x73\x63\x72\x69\x70\x74\151\x6f\156", "\x61\x2e\x73\164\141\162\164\137\x64\x61\x74\145", "\141\56\x65\156\144\x5f\144\141\x74\145", "\142\x2e\156\141\155\145"])->join("\x75\x73\145\162\163\40\141\x73\40\x62", function ($join) { $join->on("\141\x2e\143\154\x69\x65\x6e\x74\x5f\151\x64", "\75", "\x62\56\143\154\151\145\156\x74\x5f\x69\144")->on("\141\x2e\x63\x72\145\141\x74\x65\144\x5f\x62\171", "\75", "\142\x2e\x65\155\141\x69\x6c"); })->where("\x61\x2e\143\154\x69\145\x6e\x74\x5f\x69\144", "\x3d", $this->client_id)->where("\141\x2e\151\x64", "\75", $request->id)->orderBy("\x61\56\143\x72\145\141\x74\x65\x64\x5f\x61\164", "\x44\x45\123\x43")->get()->map(function ($value) { return ["\x69\144" => $value->id, "\x74\151\x74\154\x65" => $value->title, "\x64\145\x73\143\162\151\x70\x74\151\x6f\156" => $value->description, "\x73\164\141\162\164\x5f\x64\x61\164\x65" => $value->start_date, "\x65\x6e\144\x5f\x64\x61\x74\x65" => $value->end_date, "\156\x61\155\145" => $value->name]; }); goto qvSTE; JIr4L: $queries = DB::getQueryLog(); goto ahfr0; zHpDU: $cek_nilai = $this->getResult($this->client_id, $request->id, $user->id); goto IY1bI; qvSTE: $results["\x71\x75\x65\x73\x74\x69\157\x6e\x73"] = []; goto o3nih; iflky: $logs->write("\x42\111\116\104\111\116\x47", "\133" . implode("\54\40", $queries[$q]["\142\x69\x6e\144\151\156\x67\163"]) . "\x5d"); goto oq59y; E7KSe: maiTg: goto JIr4L; hCyLW: } public function store(Request $request) { goto bognN; yGaGz: $logs->write(__FUNCTION__, "\x53\x54\101\122\x54"); goto iobzX; S742d: $logs = new Logs(Arr::last(explode("\x5c", get_class())) . "\114\157\x67"); goto yGaGz; StFqD: $user = auth()->user(); goto S742d; iobzX: try { goto zAxha; o39fN: DI7hU: goto RXPAo; VO_1U: $logs->write("\x42\111\116\x44\x49\x4e\x47", "\133" . implode("\x2c\x20", $queries[$q]["\x62\151\x6e\x64\151\156\147\163"]) . "\135"); goto fs2sK; rhxhS: $q = 0; goto atzrx; ZvKWA: return response()->json("\x42\145\162\150\x61\x73\151\154\40\155\x65\x6e\x79\x69\155\160\141\x6e\x20\x6a\x61\x77\141\x62\x61\x6e\40\153\165\151\x73\x2e", 201); goto p20hX; z7E_u: OZKRb: goto sWJ9c; fs2sK: $logs->write("\x53\x51\114", $sql); goto gMky6; gMky6: m5sHt: goto AF_xD; pieJw: if (!($q < count($queries))) { goto rTdC2; } goto CAhBU; atzrx: h22rk: goto pieJw; A1Rc9: if ($success) { goto DI7hU; } goto yRAgx; tzj67: goto h22rk; goto OVXDr; OVXDr: rTdC2: goto A1Rc9; yR_vx: $quiz_id = $request->id; goto giAb9; giAb9: foreach ($request->answers as $key => $value) { goto rfZk_; HhvDP: $success = false; goto USHcL; USHcL: XblJs: goto FqCwb; rfZk_: $insert = DB::table("\x74\161\x75\151\x7a\137\x74\x72\x78")->insert(["\143\x6c\151\x65\x6e\164\x5f\x69\144" => $this->client_id, "\165\x73\x65\x72\137\151\144" => $user->id, "\163\x75\x72\166\x65\x79\137\x69\144" => $quiz_id, "\x71\165\145\163\164\x69\x6f\156\137\x69\x64" => $value["\161\x75\x65\x73\164\151\x6f\x6e\111\x64"], "\141\156\x73\x77\x65\x72\137\151\x64" => $value["\x73\145\x6c\x65\x63\x74\145\144\101\156\163\x77\145\x72"], "\164\171\x70\x65" => $value["\x74\171\160\145"], "\x70\157\x69\156\164" => $value["\x61\x6e\x73\x77\x65\x72\x50\157\x69\156\x74"], "\143\162\x65\141\164\x65\144\137\141\164" => Carbon::now("\x41\x73\151\x61\57\112\x61\153\x61\162\164\141")]); goto pJ2rj; FqCwb: nyJ5w: goto oTSv_; pJ2rj: if ($insert) { goto XblJs; } goto HhvDP; oTSv_: } goto z7E_u; RXPAo: \DB::commit(); goto yg_x3; J29_2: $logs->write(__FUNCTION__, "\123\x54\117\120\15\xa"); goto ZvKWA; vyfWd: goto DH_xg; goto o39fN; sWJ9c: $queries = DB::getQueryLog(); goto rhxhS; DHToV: \DB::beginTransaction(); goto gWtB2; v_pbF: $logs->write(__FUNCTION__, "\x53\x54\117\120\xd\12"); goto mQdfX; p20hX: DH_xg: goto ixJxu; yRAgx: \DB::rollBack(); goto KaH6t; CAhBU: $sql = Str::replaceArray("\x3f", $queries[$q]["\x62\151\x6e\144\151\156\x67\x73"], str_replace("\x3f", "\47\x3f\47", $queries[$q]["\161\x75\145\162\171"])); goto VO_1U; zAxha: DB::enableQueryLog(); goto DHToV; gWtB2: $success = true; goto yR_vx; KaH6t: $logs->write("\105\122\x52\x4f\x52", "\122\x4f\114\x4c\x42\x41\103\113"); goto v_pbF; AF_xD: $q++; goto tzj67; yg_x3: $logs->write("\x53\125\103\103\105\123\x53", "\x43\117\115\115\111\x54"); goto J29_2; mQdfX: return response()->json("\107\141\147\141\x6c\40\155\145\156\171\x69\155\x70\141\156\40\x6a\141\167\x61\x62\141\156\x20\153\x75\x69\163\56", 500); goto vyfWd; ixJxu: } catch (\Exception $e) { goto cSx6Q; jI5jK: \DB::rollBack(); goto fAWY_; cSx6Q: $logs->write("\105\x52\x52\x4f\122", $e->getMessage()); goto jI5jK; fAWY_: return response()->json("\x47\141\x67\x61\154\x20\x6d\x65\156\171\x69\x6d\x70\x61\156\40\x6a\141\167\141\x62\x61\156\40\x6b\165\x69\163\56", 500); goto J8Jr9; J8Jr9: } goto VEdnn; bognN: Carbon::setLocale("\151\144"); goto StFqD; VEdnn: } private function getResult($client_id, $survey_id, $user_id) { return DB::table("\x74\161\x75\x69\x7a\x5f\x74\x72\x78\x20\141\163\x20\141")->select(DB::raw("\123\x55\x4d\x28\141\x2e\x70\157\x69\156\164\51\40\141\x73\40\x6e\151\x6c\141\x69"), DB::raw("\x43\x4f\125\x4e\124\x28\141\56\x71\165\145\x73\x74\x69\x6f\x6e\x5f\151\x64\x29\40\141\163\40\x66\x69\x6e\x69\x73\150\x65\144"))->where("\141\56\143\154\151\145\156\x74\x5f\151\x64", "\x3d", $client_id)->where("\x61\56\163\165\162\x76\x65\171\137\151\x64", "\x3d", $survey_id)->where("\141\56\165\x73\x65\x72\137\151\x64", "\75", $user_id)->first(); } }
