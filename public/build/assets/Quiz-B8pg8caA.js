import{F as D,a as I,E}from"./vee-validate.esm-Nlz2O7Po.js";import{_ as S,c as n,d as c,a as e,F as _,e as b,g as U,n as V,w as T,r as C,o as d,t as g,b as w,i as p,s as z,P as Q,D as A}from"./sweetalert2.min-C72B2ZMm.js";import{v as B}from"./v4-DvF23Exx.js";import"./_commonjsHelpers-DSXiPLDm.js";let v;const L={components:{VeeForm:D,Field:I,ErrorMessage:E},data(){return{menu:{menu_label:"",menu_desc:"",permission:{create:!1,read:!1,update:!1,delete:!1,print:!1,approve:!1}},configsdate:{dateFormat:"Y-m-d",mode:"single"},configedate:{dateFormat:"Y-m-d",mode:"single",minDate:null},selected:[],form:{submitted:!1,new:!1,edit:!1,field:{id:"",title:"",description:"",start_date:"",end_date:"",questions:[]}},maxLength:255,maxLengthTitle:80,errors:{}}},mounted(){this.__MENU(),this.$root.web_access_log();let l=this;v=$("#data_rst").DataTable({paging:!0,pagingType:"full_numbers",lengthMenu:[[10,25,50,100,500],[10,25,50,100,500]],pageLength:25,processing:!0,serverSide:!0,deferRender:!0,stateSave:!0,select:!0,rowId:"extn",order:[[0,"asc"]],ajax:"/setting/quiz-mst",columns:[{data:"id"},{data:"title"},{data:"start_date"},{data:"end_date"},{data:"created_by"},{data:"created_at",class:"text-center"},{data:"update_by"},{data:"updated_at",class:"text-center"}],language:{lengthMenu:"_MENU_",search:"_INPUT_",searchPlaceholder:"Pencarian..",info:'<span class="fs-sm">Menampilkan _START_ sampai _END_ dari _TOTAL_ entri</span>',infoEmpty:'<span class="fs-sm">Menampilkan 0 sampai 0 dari 0 entri</span>',infoFiltered:'<span class="fs-sm">(disaring dari _MAX_ total entri)</span>',zeroRecords:'<span class="fs-sm">Tidak Ada Data</span>',paginate:{first:'<i class="bi bi-chevron-double-left"></i>',previous:'<i class="bi bi-chevron-left"></i>',next:'<i class="bi bi-chevron-right"></i>',last:'<i class="bi bi-chevron-double-right"></i>'}}}),window.$("#data_rst tbody").on("click","tr",function(){l.selected=[],window.$(this).hasClass("selected")?window.$(this).removeClass("selected"):(v.$("tr.selected").removeClass("selected"),window.$(this).addClass("selected"),v.rows(".selected").data().length>0&&l.selected.push(v.rows(".selected").data()[0]))})},methods:{__MENU(){let l=this.$loading.show();window.axios.get("/web-access-log/"+this.$route.name).then(t=>{l.hide(),this.menu.menu_label=t.data.menu_label,this.menu.menu_desc=t.data.menu_desc,this.menu.permission=t.data.permission}).catch(t=>{l.hide(),console.error(t)})},clearForm(){this.form.field.id="",this.form.field.title="",this.form.field.description="",this.form.field.start_date="",this.form.field.end_date="",this.form.field.questions=[],this.errors={}},create(){this.form.new=!0,this.form.edit=!1,this.clearForm(),this.form.field.id=B(),this.newQuestion()},edit(){this.selected.length>0?(this.form.new=!1,this.form.edit=!0,this.submitted=!1,this.form.field.id=this.selected[0].id,this.form.field.title=this.selected[0].title,this.form.field.description=this.selected[0].description,this.form.field.start_date=this.selected[0].start_date,this.form.field.end_date=this.selected[0].end_date,this.getQuiz()):this.$swal({toast:!0,icon:"warning",text:"Tidak ada baris yang dipilih!"})},destroy(){this.selected.length>0?this.$swal({icon:"question",text:"Apakah anda yakin ingin menghapus data ini?",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:'<i class="bi bi-trash-fill"></i> Hapus',cancelButtonText:'<i class="bi bi-x-square-fill"></i> Batal',buttonsStyling:!1,customClass:{confirmButton:"btn btn-sm btn-danger me-2",cancelButton:"btn btn-sm btn-secondary"}}).then(l=>{if(l.value){let t=this.$loading.show();window.axios.delete("/setting/quiz-mst/"+this.selected[0].id+"?menufn="+this.$route.name).then(a=>{t.hide(),this.selected=[],v.ajax.reload(),this.$swal({toast:!0,icon:"success",html:a.data})})}}):this.$swal({toast:!0,icon:"warning",text:"Tidak ada baris yang dipilih!"})},submit(){this.form.submitted||(this.form.submitted=!0,this.$refs.form.validate().then(l=>{if(l.valid){this.form.submitted=!1;let t=this.$loading.show();this.form.new?window.axios.post("/setting/quiz-mst?menu_fn="+this.$route.name,this.form.field).then(a=>{t.hide(),this.cancel(),this.$swal({toast:!0,position:"top",icon:a.status===201?"success":"info",html:a.data})}).catch(a=>{if(t.hide(),this.form.submitted=!1,a.response.status===422){this.$refs.form.setErrors(a.response.data.errors);for(const[k,s]of Object.entries(a.response.data.errors))this.errors[k]=s}}):window.axios.put("/setting/quiz-mst/"+this.form.field.id+"?menu_fn="+this.$route.name,this.form.field).then(a=>{t.hide(),this.cancel(),this.$swal({toast:!0,position:"top",icon:a.status===201?"success":"info",html:a.data})}).catch(a=>{t.hide(),this.form.submitted=!1,a.response.status===422&&this.$refs.form.setErrors(a.response.data.errors)})}else this.form.submitted=!1}))},cancel(){this.form.new=!1,this.form.edit=!1,this.form.submitted=!1,this.selected=[],this.clearForm(),this.$refs.form.resetForm(),v.ajax.reload(null,!1)},getQuiz(){let l=this.$loading.show();window.axios.get("/setting/quiz-mst/"+this.selected[0].id+"?menufn="+this.$route.name).then(t=>{l.hide(),t.data.questions.length>0?this.form.field.questions=t.data.questions:this.newQuestion()}).catch(t=>{l.hide()})},newQuestion(){this.form.field.questions.push({editable:!0,id:"",description:"",template_sequence:1,required:!0,type:"",point:0,flag_new:!0,visible:!0,answer:[{description:"",point:0,flag_new:!0}]})},changeType(l){l.answer=[],(l.type=="multiple"||l.type=="checklist"||l.type=="ranking")&&l.answer.push({description:"",point:0,flag_new:!0})},addQuestion(l){let t=this;l.flag_new=!1;let a=t.form.field.questions.length+1;t.form.field.questions.push({editable:!0,id:"",description:"",template_sequence:a,required:!0,type:"",point:0,flag_new:!0,visible:!0,answer:[{description:"",point:0,flag_new:!0}]})},delQuestion(l){let t=this;if(t.form.field.questions.length>1){if(t.selected.length>0&&t.selected[0].survey_id){if(t.form.field.questions.splice(t.form.field.questions.indexOf(l),1),l.id!="")return t.form.field.questions[t.form.field.questions.length-1].flag_new=!0,axios.delete("/survey-mst/"+t.selected[0].survey_id+"?question_id="+l.id)}else t.form.field.questions.splice(t.form.field.questions.indexOf(l),1);t.form.field.questions[t.form.field.questions.length-1].flag_new=!0}},addAnswer(l,t){let a=this;a.form.field.questions[l].answer[t].flag_new=!0,a.form.field.questions[l].answer.push({description:"",point:0,flag_new:!1})},delAnswer(l,t){let a=this;if(a.selected.length>0&&a.selected[0].survey_id){let k=a.form.field.questions[l].id,s=a.form.field.questions[l].answer[t].id;if(a.form.field.questions[l].answer.splice(t,1),k!=""&&s!="")return axios.delete("/survey-mst/"+a.selected[0].survey_id+"?question_id="+k+"&answer_id="+s)}else a.form.field.questions[l].answer.splice(t,1)}},computed:{cPermitted(){return this.menu.permission.create},rPermitted(){return this.menu.permission.read},uPermitted(){return this.menu.permission.update},dPermitted(){return this.menu.permission.delete},pPermitted(){return this.menu.permission.print},aPermitted(){return this.menu.permission.approve},remainingCharacters(){return this.maxLength-this.form.field.description.length},remainingCharactersTitle(){return this.maxLengthTitle-this.form.field.title.length}},watch:{"form.field.start_date"(l){l?this.configedate.minDate=l:this.configedate.minDate=null}},beforeRouteLeave(l,t,a){v&&(v.destroy(),v=null),a()}},N={class:"section"},j={class:"row"},O={class:"col-md-12"},J={class:"card"},R={class:"card-header"},H={class:"buttons"},Y=e("i",{class:"bi bi-folder-fill"},null,-1),G=e("i",{class:"bi bi-pen-fill"},null,-1),K=e("i",{class:"bi bi-trash-fill"},null,-1),W=e("i",{class:"bi bi-cloud-arrow-up-fill"},null,-1),X=e("i",{class:"bi bi-arrow-left-square-fill"},null,-1),Z={class:"card-body"},ee={class:"nav nav-tabs",id:"myTab",role:"tablist"},te={class:"nav-item",role:"presentation"},se={class:"nav-item",role:"presentation"},le={class:"tab-content",id:"myTabContent"},ie=A('<div class="table-responsive"><table class="table table-striped" id="data_rst"><thead><tr><th>ID</th><th>Judul</th><th>Dari</th><th>Sampai</th><th>dibuat oleh</th><th>dibuat pada</th><th>diperbarui oleh</th><th>diperbarui pada</th></tr></thead></table></div>',1),ae=[ie],oe={id:"basic-horizontal-layouts"},ne={class:"row"},de={class:"col-12"},re=["onSubmit"],ce={class:"form-body"},me={class:"row"},ue=e("div",{class:"col-md-2"},[e("label",{for:"id"},[b("ID "),e("span",{class:"text-danger"},"*")])],-1),fe={class:"col-md-10 form-group"},he=e("div",{class:"col-md-2"},[e("label",{for:"desc"},[b("Judul "),e("span",{class:"text-danger"},"*")])],-1),_e={class:"col-md-10 form-group"},pe=e("br",null,null,-1),be={class:"text-muted"},ge=e("div",{class:"col-md-2"},[e("label",{for:"desc"},[b("Deskripsi "),e("span",{class:"text-danger"},"*")])],-1),ve={class:"col-md-10 form-group"},ye=e("br",null,null,-1),we={class:"text-muted"},ke=e("div",{class:"col-md-2"},[e("label",{for:"start_date"},[b("Tanggal Mulai "),e("span",{class:"text-danger"},"*")])],-1),xe={class:"col-md-4 form-group"},Ve=e("div",{class:"col-md-2"},[e("label",{for:"end_date"},[b("Tanggal Selesai "),e("span",{class:"text-danger"},"*")])],-1),Ce={class:"col-md-4 form-group"},Te=e("div",{class:"col-md-12 mt-3"},"Menetapkan Pertanyaan dan Jawaban",-1),qe={class:"row"},Ue={class:"form-group mt-1 mb-0 col-md-1"},Fe=e("label",{class:"form-label mb-0"},[e("small",{class:"text-muted"},"ID")],-1),Pe={key:0,class:"invalid-feedback animated fadeIn mt-0 mb-1",style:{display:"block"}},Me={class:"form-group mt-1 mb-0 col-md-9"},De=e("label",{class:"form-label mb-0"},[e("small",{class:"text-muted"},"Pertanyaan")],-1),Ie={key:0,class:"invalid-feedback animated fadeIn mt-0 mb-1",style:{display:"block"}},Ee={class:"form-group mt-1 mb-0 col-md-2"},Se=e("label",{class:"form-label mb-0"},[e("small",{class:"text-muted"},"Urutan")],-1),ze={class:"form-group mt-1 mb-0 col-md-2"},Qe=e("label",{class:"form-label mb-0"},[e("small",{class:"text-muted"},"Tipe Jawaban")],-1),Ae=["disabled","name","onUpdate:modelValue","onChange"],Be=e("option",{value:""},"Pilih Tipe",-1),Le=e("option",{value:"essay"},"Essai",-1),Ne=e("option",{value:"multiple"},"Pilihan Ganda",-1),je=e("option",{value:"checklist"},"Checklist",-1),Oe=[Be,Le,Ne,je],Je={key:0,class:"invalid-feedback animated fadeIn mt-0 mb-1",style:{display:"block"}},Re={class:"form-group mt-1 mb-0 col-md-2"},He=e("label",{class:"form-label mb-0"},[e("small",{class:"text-muted"},"Poin")],-1),Ye={class:"input-group"},Ge={class:"input-group-append"},Ke=["onClick"],We=e("i",{class:"bi bi-x-circle"},null,-1),Xe=[We],Ze=["onClick"],$e=e("i",{class:"bi bi-plus-circle"},null,-1),et=[$e],tt=["onClick"],st=e("i",{class:"bi bi-x-circle"},null,-1),lt=[st],it={class:"row mt-3"},at={key:0,class:"col-lg-12 col-xl-12 px-4 py-2"},ot=e("label",{class:"pl-5"},"Answer Choice",-1),nt={class:"row"},dt={class:"form-group mt-1 mb-0 col-md-6"},rt=e("label",{class:"form-label mb-0"},[e("small",{class:"text-muted"},"Answer")],-1),ct={class:"input-group input-group-sm"},mt={class:"input-group-append"},ut={class:"input-group-text text-sm"},ft={key:0,class:"invalid-feedback animated fadeIn mt-0 mb-1",style:{display:"block"}},ht={class:"form-group my-1 col-md-2"},_t=e("label",{class:"form-label mb-0"},[e("small",{class:"text-muted"},"Point")],-1),pt={class:"input-group"},bt={class:"input-group-append"},gt=["onClick"],vt=e("i",{class:"bi bi-x-circle ml-1 mr-1"},null,-1),yt=[vt],wt=["onClick"],kt=e("i",{class:"bi bi-plus-circle ml-1 mr-1"},null,-1),xt=[kt];function Vt(l,t,a,k,s,m){const F=C("action-bar"),f=C("Field"),x=C("ErrorMessage"),q=C("Flatpickr"),P=C("VeeForm");return d(),n(_,null,[c(F,{data:s.menu,"menu-label":s.menu.menu_label},null,8,["data","menu-label"]),e("section",N,[e("div",j,[e("div",O,[e("div",J,[e("div",R,[e("div",H,[!s.form.new&&!s.form.edit?(d(),n(_,{key:0},[e("a",{href:"#",class:"btn icon icon-left btn-primary",onClick:t[0]||(t[0]=(...h)=>m.create&&m.create(...h))},[Y,b(" Tambah")]),e("a",{href:"#",class:"btn icon icon-left btn-success",onClick:t[1]||(t[1]=(...h)=>m.edit&&m.edit(...h))},[G,b(" Sunting")]),e("a",{href:"#",class:"btn icon icon-left btn-danger",onClick:t[2]||(t[2]=(...h)=>m.destroy&&m.destroy(...h))},[K,b(" Hapus")])],64)):(d(),n(_,{key:1},[e("a",{href:"#",class:"btn icon icon-left btn-success",onClick:t[3]||(t[3]=U((...h)=>m.submit&&m.submit(...h),["prevent"]))},[W,b(" Simpan")]),e("a",{href:"#",class:"btn icon icon-left btn-danger",onClick:t[4]||(t[4]=(...h)=>m.cancel&&m.cancel(...h))},[X,b(" Batal")])],64))])]),e("div",Z,[e("ul",ee,[e("li",te,[e("a",{class:V(["nav-link",s.form.new||s.form.edit?"disabled":"active"]),id:"data-tab","data-bs-toggle":"tab",href:"javascript:void(0);",role:"tab","aria-controls":"data","aria-selected":"true"},"Data",2)]),e("li",se,[e("a",{class:V(["nav-link",!s.form.new&&!s.form.edit?"disabled":"active"]),id:"form-tab","data-bs-toggle":"tab",href:"javascript:void(0);",role:"tab","aria-controls":"form","aria-selected":"false"},"Form",2)])]),e("div",le,[e("div",{class:V(["tab-pane fade",!s.form.new&&!s.form.edit?"show active":""]),id:"data",role:"tabpanel","aria-labelledby":"data-tab"},ae,2),e("div",{class:V(["tab-pane fade",s.form.new||s.form.edit?"show active":""]),id:"form",role:"tabpanel","aria-labelledby":"form-tab"},[e("section",oe,[e("div",ne,[e("div",de,[c(P,{ref:"form",as:"div"},{default:T(({handleSubmit:h})=>[e("form",{class:"form form-horizontal",onSubmit:U(i=>h(i,m.submit),["prevent"])},[e("div",ce,[e("div",me,[ue,e("div",fe,[c(f,{type:"text",disabled:!0,id:"id",modelValue:s.form.field.id,"onUpdate:modelValue":t[5]||(t[5]=i=>s.form.field.id=i),class:"form-control",name:"id"},null,8,["modelValue"]),c(x,{name:"id",class:"invalid-feedback animated fadeIn mt-0 mb-1",style:{display:"block"}})]),he,e("div",_e,[c(f,{type:"text",id:"title",modelValue:s.form.field.title,"onUpdate:modelValue":t[6]||(t[6]=i=>s.form.field.title=i),class:"form-control",placeholder:"Tulis judul disini",name:"title",maxlength:"80"},null,8,["modelValue"]),pe,e("small",be,g(m.remainingCharactersTitle)+"/"+g(s.maxLengthTitle),1),c(x,{name:"title",class:"invalid-feedback animated fadeIn mt-0 mb-1",style:{display:"block"}})]),ge,e("div",ve,[c(f,{as:"textarea",id:"description",modelValue:s.form.field.description,"onUpdate:modelValue":t[7]||(t[7]=i=>s.form.field.description=i),class:"form-control",placeholder:"Tulis deskripsi disini",name:"description",maxlength:"255"},null,8,["modelValue"]),ye,e("small",we,g(m.remainingCharacters)+"/"+g(s.maxLength),1),c(x,{name:"description",class:"invalid-feedback animated fadeIn mt-0 mb-1",style:{display:"block"}})]),ke,e("div",xe,[c(f,{name:"start_date"},{default:T(()=>[c(q,{modelValue:s.form.field.start_date,"onUpdate:modelValue":t[8]||(t[8]=i=>s.form.field.start_date=i),class:"form-control flatpickr-range",config:s.configsdate,placeholder:"Pilih tanggal.."},null,8,["modelValue","config"])]),_:1}),c(x,{name:"start_date",class:"invalid-feedback animated fadeIn mt-0 mb-1",style:{display:"block"}})]),Ve,e("div",Ce,[c(f,{name:"end_date"},{default:T(()=>[c(q,{modelValue:s.form.field.end_date,"onUpdate:modelValue":t[9]||(t[9]=i=>s.form.field.end_date=i),class:"form-control flatpickr-range",config:s.configedate,placeholder:"Pilih tanggal.."},null,8,["modelValue","config"])]),_:1}),c(x,{name:"end_date",class:"invalid-feedback animated fadeIn mt-0 mb-1",style:{display:"block"}})]),Te,(d(!0),n(_,null,w(s.form.field.questions,(i,r)=>(d(),n("div",{class:"col-md-12",key:r},[e("div",{class:V(["px-2 py-1 border-bottom",r%2==0?"bg-body-lighter":"bg-body-light"])},[e("div",qe,[e("div",Ue,[Fe,c(f,{type:"text",name:"questions."+r+".id",modelValue:i.id,"onUpdate:modelValue":o=>i.id=o,class:"form-control form-control-sm",placeholder:"ID = Q"+(r+1),readonly:!i.editable},null,8,["name","modelValue","onUpdate:modelValue","placeholder","readonly"]),s.errors["questions."+r+".id"]?(d(),n("div",Pe,[(d(!0),n(_,null,w(s.errors["questions."+r+".id"],(o,u)=>(d(),n("div",{key:u},g(o),1))),128))])):p("",!0)]),e("div",Me,[De,c(f,{type:"text",name:"questions."+r+".description",modelValue:i.description,"onUpdate:modelValue":o=>i.description=o,class:"form-control form-control-sm",placeholder:"Tulis pertanyaan disini",title:i.description},null,8,["name","modelValue","onUpdate:modelValue","title"]),s.errors["questions."+r+".description"]?(d(),n("div",Ie,[(d(!0),n(_,null,w(s.errors["questions."+r+".description"],(o,u)=>(d(),n("div",{key:u},g(o),1))),128))])):p("",!0)]),e("div",Ee,[Se,c(f,{type:"number",name:"questions."+r+".template_sequence",modelValue:i.template_sequence,"onUpdate:modelValue":o=>i.template_sequence=o,modelModifiers:{number:!0},min:"1",step:"1",class:"form-control form-control-sm",placeholder:"Seq. template here",title:i.template_sequence},null,8,["name","modelValue","onUpdate:modelValue","title"])]),e("div",ze,[Qe,z(e("select",{disabled:!i.editable,name:"questions."+r+".type","onUpdate:modelValue":o=>i.type=o,class:"form-select form-select-sm",onChange:o=>m.changeType(i)},Oe,40,Ae),[[Q,i.type]]),s.errors["questions."+r+".type"]?(d(),n("div",Je,[(d(!0),n(_,null,w(s.errors["questions."+r+".type"],(o,u)=>(d(),n("div",{key:u},g(o),1))),128))])):p("",!0)]),e("div",Re,[He,e("div",Ye,[c(f,{type:"text",name:"questions."+r+".point",modelValue:i.point,"onUpdate:modelValue":o=>i.point=o,modelModifiers:{number:!0},class:"form-control form-control-sm",placeholder:"Point",disabled:i.type!="essay"},null,8,["name","modelValue","onUpdate:modelValue","disabled"]),e("div",Ge,[i.flag_new?p("",!0):(d(),n("button",{key:0,type:"button",class:"btn btn-sm btn-danger ml-1",onClick:o=>m.delQuestion(i)},Xe,8,Ke)),i.flag_new?(d(),n(_,{key:1},[e("button",{type:"button",class:"btn btn-sm btn-primary ml-1",onClick:o=>m.addQuestion(i)},et,8,Ze),e("button",{type:"button",class:"btn btn-sm btn-danger ml-1",onClick:o=>m.delQuestion(i)},lt,8,tt)],64)):p("",!0)])])])]),e("div",it,[i.type=="multiple"||i.type=="checklist"||i.type=="ranking"?(d(),n("div",at,[ot,i.visible?(d(!0),n(_,{key:0},w(i.answer,(o,u)=>(d(),n("div",{class:"pl-5 py-1",key:u},[e("div",nt,[e("div",dt,[rt,e("div",ct,[e("div",mt,[e("span",ut,g(u+1>10?u+1:"0"+(u+1)),1)]),c(f,{type:"text",name:"questions."+r+".answer."+u+".description",class:"form-control form-control-sm",modelValue:o.description,"onUpdate:modelValue":y=>o.description=y,placeholder:"Write the answer here"},null,8,["name","modelValue","onUpdate:modelValue"]),s.errors["questions."+r+".answer."+u+".description"]?(d(),n("div",ft,[(d(!0),n(_,null,w(s.errors["questions."+r+".answer."+u+".description"],(y,M)=>(d(),n("div",{key:M},g(y),1))),128))])):p("",!0)])]),e("div",ht,[_t,e("div",pt,[c(f,{type:"text",name:"questions."+r+".answer."+u+".point",class:"form-control form-control-sm",modelValue:o.point,"onUpdate:modelValue":y=>o.point=y,modelModifiers:{number:!0},placeholder:"Point"},null,8,["name","modelValue","onUpdate:modelValue"]),e("div",bt,[o.flag_new?p("",!0):(d(),n("button",{key:0,type:"button",class:"btn btn-sm btn-danger ml-1",onClick:y=>m.delAnswer(r,u)},yt,8,gt)),o.flag_new?(d(),n("button",{key:1,type:"button",class:"btn btn-sm btn-primary ml-1",onClick:y=>m.addAnswer(r,u)},xt,8,wt)):p("",!0)])])])])]))),128)):p("",!0)])):p("",!0)])],2)]))),128))])])],40,re)]),_:1},512)])])])],2)])])])])])])],64)}const Ft=S(L,[["render",Vt]]);export{Ft as default};
//# sourceMappingURL=Quiz-B8pg8caA.js.map
