{"version":3,"file":"RentHistory-BGIVlEUa.js","sources":["../../../resources/js/components/member/RentHistory.vue"],"sourcesContent":["<template>\n    <section class=\"section\">\n        <div class=\"card overflow-auto\">\n            <div class=\"card-header text-center\">\n                <h2>Riwayat Peminjaman</h2>\n            </div>\n            <div class=\"card-body\">\n                <table class=\"table table-striped responsive-table\" id=\"data_rst\">\n                    <thead>\n                        <tr>\n                            <th>Judul Buku</th>\n                            <th>Cover</th>\n                            <th>Tanggal Pinjam</th>\n                            <th>Tanggal Kembali</th>\n                            <th>Status</th>\n                        </tr>\n                    </thead>\n                </table>\n            </div>\n        </div>\n    </section>\n\n    <!-- Modal for Image Preview -->\n    <div class=\"modal fade text-left\" id=\"imageModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"imageModalLabel\" aria-hidden=\"true\">\n        <div class=\"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md\" role=\"document\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h4 class=\"modal-title\" id=\"imageModalLabel\">Preview</h4>\n                    <button type=\"button\" class=\"close\" data-bs-dismiss=\"modal\" aria-label=\"Close\">\n                        <i data-feather=\"x\"></i>\n                    </button>\n                </div>\n                <div class=\"modal-body text-center\">\n                    <img id=\"modalImage\" src=\"\" class=\"img-fluid\" alt=\"Preview\" />\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-light-secondary\" data-bs-dismiss=\"modal\">\n                        <span class=\"bx bx-x d-block d-sm-none\">X</span>\n                        <span class=\"d-none d-sm-block\">Close</span>\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n    <!-- Modal for Image Preview -->\n</template>\n\n<script>\n\nlet table;\nexport default {\n    props: {\n        isAuthenticated: {\n            type: Boolean,\n            required: true\n        }\n    },\n\n    mounted() {\n        let self = this\n\n        table = $('#data_rst').DataTable({\n            paging: true,\n            pagingType: 'full_numbers',\n            lengthMenu: [[10, 25, 50, 100, 500], [10, 25, 50, 100, 500]],\n            pageLength: 25,\n            processing: true,\n            serverSide: true,\n            deferRender: true,\n            stateSave: true,\n            select: true,\n            order: [[0, \"asc\"]],\n            ajax: \"/RentHistory\",\n            columns: [\n                { data: \"title\" },\n                {\n                    data: \"cover\",\n                    render: function(data, type, row) {\n                        return '<img src=\"/storage/covers/' + data + '\" class=\"cover\" data-large=\"/storage/covers/' + data + '\" alt=\"Image\" style=\"width: 50px; cursor: pointer;\" />';\n                    }\n                },\n                { data: \"start_date\" },\n                { data: \"end_date\" },\n                { \n                    data: \"flag_end\",\n                    render: function(data, type, row) {\n                        if (data === 'Y') {\n                            return '<span class=\"badge bg-success\">Sudah Dikembalikan</span>';\n                        } else {\n                            return '<button class=\"btn btn-warning\" data-book-id=\"'+row.book_id+'\">Kembalikan</button>';\n                        }\n                    }\n                }\n            ],\n            language: {\n                lengthMenu: \"_MENU_\",\n                search: \"_INPUT_\",\n                searchPlaceholder: \"Pencarian..\",\n                info: '<span class=\"fs-sm\">Menampilkan _START_ sampai _END_ of _TOTAL_ entri</span>',\n                infoEmpty: '<span class=\"fs-sm\">Menampilkan 0 sampai 0 of 0 entri</span>',\n                infoFiltered: '<span class=\"fs-sm\">(disaring dari _MAX_ total entri)</span>',\n                zeroRecords: '<span class=\"fs-sm\">Tidak Ada Data</span>',\n                paginate: {\n                    first: '<i class=\"bi bi-chevron-double-left\"></i>',\n                    previous: '<i class=\"bi bi-chevron-left\"></i>',\n                    next: '<i class=\"bi bi-chevron-right\"></i>',\n                    last: '<i class=\"bi bi-chevron-double-right\"></i>'\n                }\n            }\n        });\n\n        window.$('#data_rst tbody').on('click', '.cover', function () {\n            // Get the large image URL from data attribute\n            var largeImageUrl = $(this).data('large');\n            \n            // Set the large image URL in the modal\n            $('#modalImage').attr('src', largeImageUrl);\n            \n            // Show the modal\n            new bootstrap.Modal(document.getElementById('imageModal')).show()\n        });\n\n        window.$('#data_rst tbody').on('click', '.btn-warning', function () {\n            var bookId = $(this).data('book-id');\n\n            self.kembaliBuku(bookId);\n        });\n    },\n\n    methods: {\n        kembaliBuku(bookId){\n            let loader = this.$loading.show();\n            window.axios.post('/ReturnBook', {\n                pdfToken: bookId\n            })\n            .then((response) => {\n                loader.hide();\n                this.$swal({\n                    text: response.data.message,\n                    icon: response.data.code == 1 ? 'success' : 'error',\n                    allowOutsideClick: false,\n                    allowEscapeKey: false,\n                    showCloseButton: false,\n                    showCancelButton: false\n                }).then((result) => {\n                    table.ajax.reload(null, false)\n                });\n            })\n            .catch((e) => {\n                loader.hide();\n                this.$swal({\n                    text: 'Terjadi kesalahan saat pinjam buku, silahkan coba kembali',\n                    icon: 'error',\n                    showCancelButton: false\n                })\n                \n            });\n        }\n    },\n\n    beforeRouteLeave (to, from, next) {\n        if (table) {\n            table.destroy();\n            table = null;\n        }\n        $('#data_rst tbody').off('click', '.cover');\n        $('#data_rst tbody').off('click', '.btn-warning');\n        next();\n    }\n}\n</script>\n"],"names":["table","_sfc_main","self","data","type","row","largeImageUrl","bookId","loader","response","result","e","to","from","next","_hoisted_1","_createStaticVNode","_createElementVNode","_openBlock","_createElementBlock","_Fragment","_hoisted_2"],"mappings":"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"}