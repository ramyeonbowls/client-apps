import{_ as k,c as n,d as v,a as e,s as u,P as m,F as b,b as _,e as x,D as P,r as w,o as r,t as g}from"./sweetalert2.min-C72B2ZMm.js";import"./_commonjsHelpers-DSXiPLDm.js";let p;const S={data(){return{menu:{menu_label:"",menu_desc:"",permission:{create:!1,read:!1,update:!1,delete:!1,print:!1,approve:!1}},configdate:{dateFormat:"Y-m-d",mode:"range",onClose:(s,t,l)=>{s.length===1&&(l.clear(),this.filter.date="")}},option:{optProv:"",optKab:"",optWL:""},filter:{date:"",provinsi:"",kabupaten:"",wl:"",status:""}}},mounted(){this.__MENU(),this.$root.web_access_log(),this.getProvinsi(),p=$("#data_rst").DataTable({paging:!0,pagingType:"full_numbers",lengthMenu:[[10,25,50,100,500],[10,25,50,100,500]],pageLength:10,processing:!0,ajax:"/report/loans-rpt?nodata=yes",columns:[{data:"wl_name",class:"text-center text-nowrap"},{data:"provinsi_name",class:"text-center text-nowrap"},{data:"kabupaten_name",class:"text-center text-nowrap"},{data:"name",class:"text-center text-nowrap"},{data:"title",class:"text-center text-nowrap"},{data:"start_date",class:"text-center text-nowrap"},{data:"end_date",class:"text-center text-nowrap"},{data:"flag_end",render:function(s,t,l){return s=="Y"?'<span class="badge bg-success">Dikembalikan</span>':'<span class="badge bg-warning">Dipinjam</span>'}}],language:{lengthMenu:"_MENU_",search:"_INPUT_",searchPlaceholder:"Pencarian..",info:'<span class="fs-sm">Menampilkan _START_ sampai _END_ dari _TOTAL_ entri</span>',infoEmpty:'<span class="fs-sm">Menampilkan 0 sampai 0 dari 0 entri</span>',infoFiltered:'<span class="fs-sm">(disaring dari _MAX_ total entri)</span>',zeroRecords:'<span class="fs-sm">Tidak Ada Data</span>',paginate:{first:'<i class="bi bi-chevron-double-left"></i>',previous:'<i class="bi bi-chevron-left"></i>',next:'<i class="bi bi-chevron-right"></i>',last:'<i class="bi bi-chevron-double-right"></i>'}}})},methods:{__MENU(){let s=this.$loading.show();window.axios.get("/web-access-log/"+this.$route.name).then(t=>{s.hide(),this.menu.menu_label=t.data.menu_label,this.menu.menu_desc=t.data.menu_desc,this.menu.permission=t.data.permission}).catch(t=>{s.hide(),console.error(t)})},getProvinsi(){this.option.optProv="",this.option.optKab="",this.option.optWL="";let s=this.$loading.show();window.axios.post("/getOpt",{opt:"Provinsi"}).then(t=>{s.hide(),this.option.optProv=t.data,this.option.optProv.length==1&&(this.filter.provinsi=this.option.optProv[0].provinsi_id,this.getKabupaten())}).catch(t=>{s.hide(),console.error(t)})},getKabupaten(){this.option.optKab="",this.option.optWL="",window.axios.post("/getOpt",{opt:"Kabupaten",PROVINSI:this.filter.provinsi}).then(s=>{this.option.optKab=s.data,this.option.optKab.length==1&&(this.filter.kabupaten=this.option.optKab[0].kabupaten_id,this.getWhiteLabel())}).catch(s=>{console.error(s)})},getWhiteLabel(){this.option.optWL="",window.axios.post("/getOpt",{opt:"WhiteLabel",PROVINSI:this.filter.provinsi,KABUPATEN:this.filter.kabupaten}).then(s=>{this.option.optWL=s.data,this.option.optWL.length==1&&(this.filter.wl=this.option.optWL[0].instansi_name)}).catch(s=>{console.error(s)})},openExecute(){let s=!0,t="";if(this.filter.provinsi==""&&(s=!1,t+=" Provinsi, "),this.filter.kabupaten==""&&(s=!1,t+=" Kabupaten, "),this.filter.wl==""&&(s=!1,t+=" White Label, "),(this.filter.date===""||this.filter.date===null)&&(s=!1,t+=" Tanggal, "),!s)this.$swal({toast:!0,icon:"warning",text:"Silahkan Isi"+t.slice(0,-2)+"!"});else{let l=this.filter.date.split(" to ")[0]??"",h=this.filter.date.split(" to ")[1]??"",i="PROVINSI="+this.filter.provinsi;i+="&KABUPATEN="+this.filter.kabupaten,i+="&WL="+this.filter.wl,i+="&START_DATE="+l,i+="&END_DATE="+h,i+="&STATUS="+this.filter.status,p.ajax.url("/report/loans-rpt?menufn="+this.$route.name+"&"+i).load()}},openXLS(){let s=!0,t="";if(this.filter.provinsi==""&&(s=!1,t+=" Provinsi, "),this.filter.kabupaten==""&&(s=!1,t+=" Kabupaten, "),this.filter.wl==""&&(s=!1,t+=" White Label, "),(this.filter.date===""||this.filter.date===null)&&(s=!1,t+=" Tanggal, "),!s)this.$swal({toast:!0,icon:"warning",text:"Silahkan Isi"+t.slice(0,-2)+"!"});else{let l=this.$loading.show(),h=this.filter.date.split(" to ")[0]??"",i=this.filter.date.split(" to ")[1]??"";window.axios({url:"/report/loans-xls",method:"POST",responseType:"blob",data:{PROVINSI:this.filter.provinsi,KABUPATEN:this.filter.kabupaten,WL:this.filter.wl,START_DATE:h,END_DATE:i,STATUS:this.filter.status}}).then(o=>{l.hide();const f=window.URL.createObjectURL(new Blob([o.data])),d=document.createElement("a");d.href=f,d.setAttribute("download","Laporan Pinjaman Buku "+this.filter.date+".xlsx"),document.body.appendChild(d),d.click()}).catch(o=>{console.error(o),l.hide()})}}},computed:{cPermitted(){return this.menu.permission.create},rPermitted(){return this.menu.permission.read},uPermitted(){return this.menu.permission.update},dPermitted(){return this.menu.permission.delete},pPermitted(){return this.menu.permission.print},aPermitted(){return this.menu.permission.approve}},beforeRouteLeave(s,t,l){p&&(p.destroy(),p=null),l()}},L={class:"modal fade text-left modal-borderless",id:"border-less",tabindex:"-1",role:"dialog","aria-labelledby":"myModalLabel1","aria-hidden":"true"},T={class:"modal-dialog modal-lg modal-dialog-scrollable",role:"document"},K={class:"modal-content"},N=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Filter"),e("button",{type:"button",class:"close rounded-pill","data-bs-dismiss":"modal","aria-label":"Close"},[e("i",{"data-feather":"x"})])],-1),y={class:"modal-body"},E={class:"row"},A={class:"col-md-6 col-6"},W={class:"row"},D={class:"col-md-12 mb-12"},U={class:"form-group"},V=e("label",{for:"basicSelect1",class:"form-label"},"Provinsi",-1),R=e("option",{value:""},"--",-1),I=["value"],M={class:"col-md-12 mb-12"},O={class:"form-group"},B=e("label",{for:"basicSelect2",class:"form-label"},"Kabupaten/Kota",-1),C=e("option",{value:""},"--",-1),F=["value"],j={class:"col-md-12 mb-12"},X={class:"form-group"},Y=e("label",{for:"basicSelect4",class:"form-label"},"Status",-1),q=e("option",{value:""},"--",-1),z=e("option",{value:"N"},"Dipinjam",-1),J=e("option",{value:"Y"},"Dikembalikan",-1),G=[q,z,J],H={class:"col-md-6 col-6"},Q={class:"row"},Z={class:"col-md-12 mb-12"},tt={class:"form-group"},et=e("label",{for:"basicSelect3",class:"form-label"},"White Label",-1),st=e("option",{value:""},"--",-1),at=["value"],it={class:"col-md-12 mb-12"},ot={class:"form-group"},lt=e("label",{for:"sdate",class:"form-label"},"Tanggal",-1),nt={class:"modal-footer"},rt=e("i",{class:"bi bi-file-earmark-excel-fill"},null,-1),dt=e("i",{class:"bi bi-file-earmark-excel-fill"},null,-1),ct=P('<section class="section"><div class="card overflow-auto"><div class="card-header"><div class="buttons"><a href="#" class="btn icon icon-left btn-primary" data-bs-toggle="modal" data-bs-target="#border-less"><i class="bi bi-filter-square-fill"></i> Filter</a></div></div><div class="card-body"><table class="table table-striped" id="data_rst"><thead><tr><th class="text-center">Nama WL</th><th class="text-center">Provinsi</th><th class="text-center">Kab/Kota</th><th class="text-center">Nama Member</th><th class="text-center">Judul Buku</th><th class="text-center">Tanggal Pinjam</th><th class="text-center">Tanggal Kembali</th><th class="text-center">Status</th></tr></thead></table></div></div></section>',1);function pt(s,t,l,h,i,o){const f=w("action-bar"),d=w("Flatpickr");return r(),n(b,null,[v(f,{data:i.menu,"menu-label":i.menu.menu_label},null,8,["data","menu-label"]),e("div",L,[e("div",T,[e("div",K,[N,e("div",y,[e("div",E,[e("div",A,[e("div",W,[e("div",D,[e("div",U,[V,u(e("select",{class:"form-select",id:"basicSelect1","onUpdate:modelValue":t[0]||(t[0]=a=>i.filter.provinsi=a),onChange:t[1]||(t[1]=(...a)=>o.getKabupaten&&o.getKabupaten(...a))},[R,(r(!0),n(b,null,_(i.option.optProv,(a,c)=>(r(),n("option",{key:c,value:a.provinsi_id},g(a.provinsi_id+" "+a.provinsi_name),9,I))),128))],544),[[m,i.filter.provinsi]])])]),e("div",M,[e("div",O,[B,u(e("select",{class:"form-select",id:"basicSelect2","onUpdate:modelValue":t[2]||(t[2]=a=>i.filter.kabupaten=a),onChange:t[3]||(t[3]=(...a)=>o.getWhiteLabel&&o.getWhiteLabel(...a))},[C,(r(!0),n(b,null,_(i.option.optKab,(a,c)=>(r(),n("option",{key:c,value:a.kabupaten_id},g(a.kabupaten_id+" "+a.kabupaten_name),9,F))),128))],544),[[m,i.filter.kabupaten]])])]),e("div",j,[e("div",X,[Y,u(e("select",{class:"form-select",id:"basicSelect4","onUpdate:modelValue":t[4]||(t[4]=a=>i.filter.status=a)},G,512),[[m,i.filter.status]])])])])]),e("div",H,[e("div",Q,[e("div",Z,[e("div",tt,[et,u(e("select",{class:"form-select",id:"basicSelect3","onUpdate:modelValue":t[5]||(t[5]=a=>i.filter.wl=a)},[st,(r(!0),n(b,null,_(i.option.optWL,(a,c)=>(r(),n("option",{key:c,value:a.instansi_name},g(a.instansi_name),9,at))),128))],512),[[m,i.filter.wl]])])]),e("div",it,[e("div",ot,[lt,v(d,{modelValue:i.filter.date,"onUpdate:modelValue":t[6]||(t[6]=a=>i.filter.date=a),class:"form-control flatpickr-range",config:i.configdate,placeholder:"Select date.."},null,8,["modelValue","config"])])])])])])]),e("div",nt,[e("button",{type:"button",class:"btn btn-primary ms-1","data-bs-dismiss":"modal",onClick:t[7]||(t[7]=(...a)=>o.openExecute&&o.openExecute(...a))},[rt,x(" Proses Data ")]),e("button",{type:"button",class:"btn btn-success ms-1","data-bs-dismiss":"modal",onClick:t[8]||(t[8]=(...a)=>o.openXLS&&o.openXLS(...a))},[dt,x(" Export ")])])])])]),ct],64)}const mt=k(S,[["render",pt]]);export{mt as default};
//# sourceMappingURL=ReportLoans-CKTWpVvF.js.map
