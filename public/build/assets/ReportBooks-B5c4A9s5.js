import{_ as g,c as n,d as x,a as e,s as u,P as b,F as h,b as m,e as f,D as w,r as k,o as r,t as _}from"./sweetalert2.min-C72B2ZMm.js";import"./_commonjsHelpers-DSXiPLDm.js";let c;const P={data(){return{menu:{menu_label:"",menu_desc:"",permission:{create:!1,read:!1,update:!1,delete:!1,print:!1,approve:!1}},option:{optProv:"",optKab:"",optWL:""},filter:{provinsi:"",kabupaten:"",wl:""}}},mounted(){this.__MENU(),this.$root.web_access_log(),this.getProvinsi(),c=$("#data_rst").DataTable({paging:!0,pagingType:"full_numbers",lengthMenu:[[10,25,50,100,500],[10,25,50,100,500]],pageLength:10,processing:!0,ajax:"/report/books-rpt?nodata=yes",columns:[{data:"wl_name",class:"text-center text-nowrap"},{data:"provinsi_name",class:"text-center text-nowrap"},{data:"kabupaten_name",class:"text-center text-nowrap"},{data:"title",class:"text-center text-nowrap"},{data:"publisher",class:"text-center text-nowrap"},{data:"writer",class:"text-center text-nowrap"},{data:"isbn",class:"text-center text-nowrap"},{data:"eisbn",class:"text-center text-nowrap"},{data:"qty",class:"text-right"}],language:{lengthMenu:"_MENU_",search:"_INPUT_",searchPlaceholder:"Pencarian..",info:'<span class="fs-sm">Menampilkan _START_ sampai _END_ dari _TOTAL_ entri</span>',infoEmpty:'<span class="fs-sm">Menampilkan 0 sampai 0 dari 0 entri</span>',infoFiltered:'<span class="fs-sm">(disaring dari _MAX_ total entri)</span>',zeroRecords:'<span class="fs-sm">Tidak Ada Data</span>',paginate:{first:'<i class="bi bi-chevron-double-left"></i>',previous:'<i class="bi bi-chevron-left"></i>',next:'<i class="bi bi-chevron-right"></i>',last:'<i class="bi bi-chevron-double-right"></i>'}}})},methods:{__MENU(){let s=this.$loading.show();window.axios.get("/web-access-log/"+this.$route.name).then(t=>{s.hide(),this.menu.menu_label=t.data.menu_label,this.menu.menu_desc=t.data.menu_desc,this.menu.permission=t.data.permission}).catch(t=>{s.hide(),console.error(t)})},getProvinsi(){this.option.optProv="",this.option.optKab="",this.option.optWL="";let s=this.$loading.show();window.axios.post("/getOpt",{opt:"Provinsi"}).then(t=>{s.hide(),this.option.optProv=t.data,this.option.optProv.length==1&&(this.filter.provinsi=this.option.optProv[0].provinsi_id,this.getKabupaten())}).catch(t=>{s.hide(),console.error(t)})},getKabupaten(){this.option.optKab="",this.option.optWL="",window.axios.post("/getOpt",{opt:"Kabupaten",PROVINSI:this.filter.provinsi}).then(s=>{this.option.optKab=s.data,this.option.optKab.length==1&&(this.filter.kabupaten=this.option.optKab[0].kabupaten_id,this.getWhiteLabel())}).catch(s=>{console.error(s)})},getWhiteLabel(){this.option.optWL="",window.axios.post("/getOpt",{opt:"WhiteLabel",PROVINSI:this.filter.provinsi,KABUPATEN:this.filter.kabupaten}).then(s=>{this.option.optWL=s.data,this.option.optWL.length==1&&(this.filter.wl=this.option.optWL[0].instansi_name)}).catch(s=>{console.error(s)})},openExecute(){let s=!0,t="";if(this.filter.provinsi==""&&(s=!1,t+=" Provinsi, "),this.filter.kabupaten==""&&(s=!1,t+=" Kabupaten, "),this.filter.wl==""&&(s=!1,t+=" White Label, "),!s)this.$swal({toast:!0,icon:"warning",text:"Silahkan Isi"+t.slice(0,-2)+"!"});else{let l="PROVINSI="+this.filter.provinsi;l+="&KABUPATEN="+this.filter.kabupaten,l+="&WL="+this.filter.wl,c.ajax.url("/report/books-rpt?menufn="+this.$route.name+"&"+l).load()}},openXLS(){let s=!0,t="";if(this.filter.provinsi==""&&(s=!1,t+=" Provinsi, "),this.filter.kabupaten==""&&(s=!1,t+=" Kabupaten, "),this.filter.wl==""&&(s=!1,t+=" White Label, "),!s)this.$swal({toast:!0,icon:"warning",text:"Silahkan Isi"+t.slice(0,-2)+"!"});else{let l=this.$loading.show();window.axios({url:"/report/books-xls",method:"POST",responseType:"blob",data:{PROVINSI:this.filter.provinsi,KABUPATEN:this.filter.kabupaten,WL:this.filter.wl}}).then(p=>{l.hide();const a=window.URL.createObjectURL(new Blob([p.data])),o=document.createElement("a");o.href=a,o.setAttribute("download","Laporan Buku "+this.filter.wl+".xlsx"),document.body.appendChild(o),o.click()}).catch(p=>{console.error(p),l.hide()})}}},computed:{cPermitted(){return this.menu.permission.create},rPermitted(){return this.menu.permission.read},uPermitted(){return this.menu.permission.update},dPermitted(){return this.menu.permission.delete},pPermitted(){return this.menu.permission.print},aPermitted(){return this.menu.permission.approve}},beforeRouteLeave(s,t,l){c&&(c.destroy(),c=null),l()}},L={class:"modal fade text-left modal-borderless",id:"border-less",tabindex:"-1",role:"dialog","aria-labelledby":"myModalLabel1","aria-hidden":"true"},S={class:"modal-dialog modal-lg modal-dialog-scrollable",role:"document"},y={class:"modal-content"},K=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Filter"),e("button",{type:"button",class:"close rounded-pill","data-bs-dismiss":"modal","aria-label":"Close"},[e("i",{"data-feather":"x"})])],-1),N={class:"modal-body"},W={class:"row"},E={class:"col-md-6 col-6"},T={class:"row"},I={class:"col-md-12 mb-12"},B={class:"form-group"},U=e("label",{for:"basicSelect1",class:"form-label"},"Provinsi",-1),A=e("option",{value:""},"--",-1),V=["value"],M={class:"col-md-12 mb-12"},O={class:"form-group"},R=e("label",{for:"basicSelect2",class:"form-label"},"Kabupaten/Kota",-1),C=e("option",{value:""},"--",-1),D=["value"],F={class:"col-md-6 col-6"},X={class:"row"},j={class:"col-md-12 mb-12"},q={class:"form-group"},z=e("label",{for:"basicSelect3",class:"form-label"},"White Label",-1),J=e("option",{value:""},"--",-1),G=["value"],H={class:"modal-footer"},Q=e("i",{class:"bi bi-file-earmark-excel-fill"},null,-1),Y=e("i",{class:"bi bi-file-earmark-excel-fill"},null,-1),Z=w('<section class="section"><div class="card overflow-auto"><div class="card-header"><div class="buttons"><a href="#" class="btn icon icon-left btn-primary" data-bs-toggle="modal" data-bs-target="#border-less"><i class="bi bi-filter-square-fill"></i> Filter</a></div></div><div class="card-body"><table class="table table-striped" id="data_rst"><thead><tr><th class="text-center">Nama WL</th><th class="text-center">Provinsi</th><th class="text-center">Kab/Kota</th><th class="text-center">Judul Buku</th><th class="text-center">Penerbit</th><th class="text-center">Penulis</th><th class="text-center">ISBN</th><th class="text-center">EISBN</th><th class="text-center">Copy</th></tr></thead></table></div></div></section>',1);function tt(s,t,l,p,a,o){const v=k("action-bar");return r(),n(h,null,[x(v,{data:a.menu,"menu-label":a.menu.menu_label},null,8,["data","menu-label"]),e("div",L,[e("div",S,[e("div",y,[K,e("div",N,[e("div",W,[e("div",E,[e("div",T,[e("div",I,[e("div",B,[U,u(e("select",{class:"form-select",id:"basicSelect1","onUpdate:modelValue":t[0]||(t[0]=i=>a.filter.provinsi=i),onChange:t[1]||(t[1]=(...i)=>o.getKabupaten&&o.getKabupaten(...i))},[A,(r(!0),n(h,null,m(a.option.optProv,(i,d)=>(r(),n("option",{key:d,value:i.provinsi_id},_(i.provinsi_id+" "+i.provinsi_name),9,V))),128))],544),[[b,a.filter.provinsi]])])]),e("div",M,[e("div",O,[R,u(e("select",{class:"form-select",id:"basicSelect2","onUpdate:modelValue":t[2]||(t[2]=i=>a.filter.kabupaten=i),onChange:t[3]||(t[3]=(...i)=>o.getWhiteLabel&&o.getWhiteLabel(...i))},[C,(r(!0),n(h,null,m(a.option.optKab,(i,d)=>(r(),n("option",{key:d,value:i.kabupaten_id},_(i.kabupaten_id+" "+i.kabupaten_name),9,D))),128))],544),[[b,a.filter.kabupaten]])])])])]),e("div",F,[e("div",X,[e("div",j,[e("div",q,[z,u(e("select",{class:"form-select",id:"basicSelect3","onUpdate:modelValue":t[4]||(t[4]=i=>a.filter.wl=i)},[J,(r(!0),n(h,null,m(a.option.optWL,(i,d)=>(r(),n("option",{key:d,value:i.instansi_name},_(i.instansi_name),9,G))),128))],512),[[b,a.filter.wl]])])])])])])]),e("div",H,[e("button",{type:"button",class:"btn btn-primary ms-1","data-bs-dismiss":"modal",onClick:t[5]||(t[5]=(...i)=>o.openExecute&&o.openExecute(...i))},[Q,f(" Proses Data ")]),e("button",{type:"button",class:"btn btn-success ms-1","data-bs-dismiss":"modal",onClick:t[6]||(t[6]=(...i)=>o.openXLS&&o.openXLS(...i))},[Y,f(" Export ")])])])])]),Z],64)}const it=g(P,[["render",tt]]);export{it as default};
//# sourceMappingURL=ReportBooks-B5c4A9s5.js.map
