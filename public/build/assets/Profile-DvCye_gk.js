import{_,c as d,a as s,t as h,i as p,g as v,s as n,v as c,n as f,P as g,d as b,r as w,o as u}from"./sweetalert2.min-C72B2ZMm.js";import"./_commonjsHelpers-DSXiPLDm.js";const k={props:{isAuthenticated:{type:Boolean,required:!0}},data(){return{user:{name:"",email:"",password:"",passwordConfirm:"",phone:"",gender:"",birthday:"",nik:"",avatar:""},errors:{},csrfToken:"",configdate:{dateFormat:"Y-m-d",disableMobile:!0}}},mounted(){this.csrfToken=document.head.querySelector('meta[name="csrf-token"]').content,this.getProfile(),this.uploadImage(),this.initializeSubMenu()},methods:{async SendVerification(){let r=this.$loading.show();try{const e=await window.axios.post("/email/resend");this.$swal({title:"Email Terkirim!",text:e.data.message,icon:"success"}),r.hide()}catch(e){r.hide(),this.$swal({title:"Gagal!",text:e.response.data.message||"Terjadi kesalahan saat mengirim email.",icon:"error"})}},async handleUpdateProfile(){if(this.user.password!=""&&this.user.password!==this.user.passwordConfirm){this.errors.passwordConfirm=["Kata sandi tidak sesuai!"];return}if(this.user.birthday==""){this.errors.isBirthdayValid=["Pilih Tanggal Lahir"];return}let r=new FormData;Object.keys(this.user).forEach(t=>{r.append(t,this.user[t])}),this.user.avatar&&r.append("avatar",this.user.avatar);let e=this.$loading.show();await axios.post("/UpdateProfile",r).then(t=>{e.hide(),this.$swal({title:"Update Profile",text:t.data,icon:t.status===201?"success":"error",allowOutsideClick:!1,allowEscapeKey:!1,showCloseButton:!1,showCancelButton:!1}).then(l=>{location.reload()})}).catch(t=>{if(e.hide(),t.response&&t.response.status===400){this.errors=t.response.data.errors;let l="";for(let o in this.errors)this.errors.hasOwnProperty(o)&&(l+=`${this.errors[o][0]}
`);this.$swal({icon:"error",title:"Kesalahan",text:l})}else this.$swal({icon:"error",title:"Kesalahan",text:"Terjadi kesalahan, silakan coba lagi nanti."})})},getProfile(){this.user={name:"",email:"",password:"",passwordConfirm:"",phone:"",gender:"",birthday:"",nik:"",avatar:""};let r=this.$loading.show();axios.get("/getProfile").then(e=>{this.user=e.data,this.user.password="",this.user.passwordConfirm="",r.hide()}).catch(e=>{r.hide(),console.error(e)})},filterInput(r,e){e=="nik"?this.user.nik=r.target.value.replace(/\D/g,""):e=="phone"&&(this.user.phone=r.target.value.replace(/\D/g,""))},uploadImage(){const r=document.getElementById("AvatarFileUpload"),e=r.querySelector(".selected-image-holder>img"),t=r.querySelector(".avatar-selector-btn"),l=r.querySelector('input[name="avatar"]');t.addEventListener("click",o=>{o.preventDefault(),l.click()}),l.addEventListener("change",o=>{const a=o.target.files[0];if(a.type!=="image/jpeg"){this.$swal({icon:"error",title:"File Tidak Valid",text:"Hanya file JPG yang diperbolehkan."}),o.target.value="";return}if(a.size>1048576){this.$swal({title:"Gagal!",text:"Ukuran file tidak boleh lebih dari 1MB.",icon:"error"}),o.target.value="";return}var m=new FileReader;m.onload=function(){e.src=m.result},this.user.avatar=a,m.readAsDataURL(a)})},initializeSubMenu(){document.querySelectorAll(".submenu-item").forEach(e=>{e.querySelector(".submenu-link").addEventListener("click",t=>{let l=document.querySelector(".main-navbar");l.classList.contains("active")&&l.classList.remove("active"),t.preventDefault()})})}},watch:{"user.password"(r,e){this.errors.password&&(this.errors.password=null),r!==this.user.passwordConfirm?this.errors.passwordConfirm=["Kata sandi tidak sesuai!"]:this.errors.passwordConfirm=null},"user.passwordConfirm"(r,e){this.errors.passwordConfirm&&(this.errors.passwordConfirm=null),r!==this.user.password?this.errors.passwordConfirm=["Kata sandi tidak sesuai!"]:this.errors.passwordConfirm=null}}},y={class:"page-heading"},x=s("div",{class:"page-title"},[s("div",{class:"row"},[s("div",{class:"col-12 col-md-6 order-md-1 order-last"},[s("h3",null,"Profil Saya")])])],-1),C={class:"section"},V={class:"row"},S={class:"col-12 col-lg-4"},U={class:"card"},P={class:"card-body"},I={class:"d-flex justify-content-center align-items-center flex-column"},K={id:"AvatarFileUpload"},q={class:"selected-image-holder"},L=["src"],E=s("div",{class:"avatar-selector"},[s("a",{href:"#",class:"avatar-selector-btn"},[s("i",{class:"bi bi-camera-fill"})]),s("input",{type:"file",accept:".jpg",name:"avatar"})],-1),B={class:"mt-3"},M={class:"col-12 col-lg-8"},N={class:"card"},F={class:"card-body"},T={class:"row"},j={class:"col-md-6 col-12"},D={class:"form-group"},A=s("label",{for:"name-column"},"Nama Lengkap",-1),z={class:"form-group position-relative has-icon-left mb-4"},G=s("div",{class:"form-control-icon"},[s("i",{class:"bi bi-person"})],-1),H={class:"col-md-6 col-12"},O={class:"form-group"},J=s("label",{for:"email-column"},"Email",-1),R={class:"form-group position-relative has-icon-left mb-4"},Y=["readonly"],Q=s("div",{class:"form-control-icon"},[s("i",{class:"bi bi-envelope"})],-1),W={key:0,class:"invalid-feedback"},X={class:"col-md-6 col-12"},Z={class:"form-group"},$=s("label",{for:"no-hp-column"},"No. HP",-1),ss={class:"form-group position-relative has-icon-left mb-4"},es=s("div",{class:"form-control-icon"},[s("i",{class:"bi bi-phone"})],-1),os={class:"col-md-6 col-12"},is={class:"form-group"},rs=s("label",{for:"jenis-kelamin-floating"},"Jenis Kelamin",-1),ts=s("option",{value:""},"--",-1),as=s("option",{value:"L"},"Laki - Laki",-1),ls=s("option",{value:"P"},"Perempuan",-1),ns=[ts,as,ls],ds={class:"col-md-6 col-12"},cs={class:"form-group"},us=s("label",{for:"tanggal-lahir"},"Tanggal Lahir",-1),ms={class:"form-group position-relative has-icon-left mb-4"},hs=s("div",{class:"form-control-icon"},[s("i",{class:"bi bi-calendar3"})],-1),ps={key:0,class:"text-danger"},fs={class:"col-md-6 col-12"},_s={class:"form-group"},vs=s("label",{for:"nik"},"NIK",-1),gs={class:"form-group position-relative has-icon-left mb-4"},bs=s("div",{class:"form-control-icon"},[s("i",{class:"bi bi-credit-card"})],-1),ws={class:"col-md-6 col-12"},ks={class:"form-group"},ys=s("label",{for:"password-column"},"Kata Sandi",-1),xs={class:"form-group position-relative has-icon-left mb-4"},Cs=s("div",{class:"form-control-icon"},[s("i",{class:"bi bi-shield-lock"})],-1),Vs=s("p",{class:"text-subtitle text-muted"},"Isi jika ingin ubah password",-1),Ss={key:0,class:"invalid-feedback"},Us={class:"col-md-6 col-12"},Ps={class:"form-group"},Is=s("label",{for:"password-confirm-column"},"Ulangi Kata Sandi",-1),Ks={class:"form-group position-relative has-icon-left mb-4"},qs=s("div",{class:"form-control-icon"},[s("i",{class:"bi bi-shield-lock"})],-1),Ls={key:0,class:"invalid-feedback"},Es=s("div",{class:"form-group"},[s("button",{type:"submit",class:"btn btn-primary"},"Simpan Perubahan")],-1);function Bs(r,e,t,l,o,a){const m=w("Flatpickr");return u(),d("div",y,[x,s("section",C,[s("div",V,[s("div",S,[s("div",U,[s("div",P,[s("div",I,[s("div",K,[s("div",q,[s("img",{src:o.user.avatar+"?"+Math.floor(Math.random()*900)+100},null,8,L)]),E]),s("h3",B,h(o.user.name),1),o.user.verified?p("",!0):(u(),d("button",{key:0,class:"btn btn-primary",onClick:e[0]||(e[0]=(...i)=>a.SendVerification&&a.SendVerification(...i))},"Kirim Email Verifikasi"))])])])]),s("div",M,[s("div",N,[s("div",F,[s("form",{class:"form",onSubmit:e[11]||(e[11]=v((...i)=>a.handleUpdateProfile&&a.handleUpdateProfile(...i),["prevent"]))},[s("div",T,[s("div",j,[s("div",D,[A,s("div",z,[n(s("input",{type:"text",class:"form-control form-control-md",placeholder:"Nama Lengkap","onUpdate:modelValue":e[1]||(e[1]=i=>o.user.name=i),required:""},null,512),[[c,o.user.name]]),G])])]),s("div",H,[s("div",O,[J,s("div",R,[n(s("input",{type:"text",class:f(["form-control form-control-md",{"is-invalid":o.errors.email}]),placeholder:"Email","onUpdate:modelValue":e[2]||(e[2]=i=>o.user.email=i),required:"",readonly:o.user.verified},null,10,Y),[[c,o.user.email]]),Q,o.errors.email?(u(),d("div",W,h(o.errors.email[0]),1)):p("",!0)])])]),s("div",X,[s("div",Z,[$,s("div",ss,[n(s("input",{type:"text",id:"phoneNumberInput",class:"form-control form-control-md",placeholder:"No. Handphone",maxlength:"15",required:"","onUpdate:modelValue":e[3]||(e[3]=i=>o.user.phone=i),onInput:e[4]||(e[4]=i=>a.filterInput(i,"phone"))},null,544),[[c,o.user.phone]]),es])])]),s("div",os,[s("div",is,[rs,n(s("select",{class:"form-select",id:"gender","onUpdate:modelValue":e[5]||(e[5]=i=>o.user.gender=i),required:""},ns,512),[[g,o.user.gender]])])]),s("div",ds,[s("div",cs,[us,s("div",ms,[b(m,{modelValue:o.user.birthday,"onUpdate:modelValue":e[6]||(e[6]=i=>o.user.birthday=i),class:"form-control flatpickr-range",config:o.configdate,placeholder:"Select date..",required:""},null,8,["modelValue","config"]),hs,o.errors.isBirthdayValid?(u(),d("span",ps,h(o.errors.isBirthdayValid[0]),1)):p("",!0)])])]),s("div",fs,[s("div",_s,[vs,s("div",gs,[n(s("input",{type:"text",id:"nikInput",class:"form-control form-control-md",placeholder:"Nomor Induk Kependudukan",maxlength:"20","onUpdate:modelValue":e[7]||(e[7]=i=>o.user.nik=i),onInput:e[8]||(e[8]=i=>a.filterInput(i,"nik"))},null,544),[[c,o.user.nik]]),bs])])]),s("div",ws,[s("div",ks,[ys,s("div",xs,[n(s("input",{type:"password",class:f(["form-control form-control-md",{"is-invalid":o.errors.password}]),placeholder:"Kata Sandi","onUpdate:modelValue":e[9]||(e[9]=i=>o.user.password=i)},null,2),[[c,o.user.password]]),Cs,Vs,o.errors.password?(u(),d("div",Ss,h(o.errors.password[0]),1)):p("",!0)])])]),s("div",Us,[s("div",Ps,[Is,s("div",Ks,[n(s("input",{type:"password",class:f(["form-control form-control-md",{"is-invalid":o.errors.passwordConfirm}]),placeholder:"Ulangi Kata Sandi","onUpdate:modelValue":e[10]||(e[10]=i=>o.user.passwordConfirm=i)},null,2),[[c,o.user.passwordConfirm]]),qs,o.errors.passwordConfirm?(u(),d("div",Ls,h(o.errors.passwordConfirm[0]),1)):p("",!0)])])]),Es])],32)])])])])])])}const Fs=_(k,[["render",Bs]]);export{Fs as default};
//# sourceMappingURL=Profile-DvCye_gk.js.map
